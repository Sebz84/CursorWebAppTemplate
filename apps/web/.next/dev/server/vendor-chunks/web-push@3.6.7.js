"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
exports.id = "vendor-chunks/web-push@3.6.7";
exports.ids = ["vendor-chunks/web-push@3.6.7"];
exports.modules = {

/***/ "(action-browser)/../../node_modules/.pnpm/web-push@3.6.7/node_modules/web-push/src/encryption-helper.js":
/*!**********************************************************************************************!*\
  !*** ../../node_modules/.pnpm/web-push@3.6.7/node_modules/web-push/src/encryption-helper.js ***!
  \**********************************************************************************************/
/***/ ((module, __unused_webpack_exports, __webpack_require__) => {

eval("\n\nconst crypto = __webpack_require__(/*! crypto */ \"crypto\");\nconst ece = __webpack_require__(/*! http_ece */ \"(action-browser)/../../node_modules/.pnpm/http_ece@1.2.0/node_modules/http_ece/ece.js\");\n\nconst encrypt = function(userPublicKey, userAuth, payload, contentEncoding) {\n  if (!userPublicKey) {\n    throw new Error('No user public key provided for encryption.');\n  }\n\n  if (typeof userPublicKey !== 'string') {\n    throw new Error('The subscription p256dh value must be a string.');\n  }\n\n  if (Buffer.from(userPublicKey, 'base64url').length !== 65) {\n    throw new Error('The subscription p256dh value should be 65 bytes long.');\n  }\n\n  if (!userAuth) {\n    throw new Error('No user auth provided for encryption.');\n  }\n\n  if (typeof userAuth !== 'string') {\n    throw new Error('The subscription auth key must be a string.');\n  }\n\n  if (Buffer.from(userAuth, 'base64url').length < 16) {\n    throw new Error('The subscription auth key should be at least 16 '\n    + 'bytes long');\n  }\n\n  if (typeof payload !== 'string' && !Buffer.isBuffer(payload)) {\n    throw new Error('Payload must be either a string or a Node Buffer.');\n  }\n\n  if (typeof payload === 'string' || payload instanceof String) {\n    payload = Buffer.from(payload);\n  }\n\n  const localCurve = crypto.createECDH('prime256v1');\n  const localPublicKey = localCurve.generateKeys();\n\n  const salt = crypto.randomBytes(16).toString('base64url');\n\n  const cipherText = ece.encrypt(payload, {\n    version: contentEncoding,\n    dh: userPublicKey,\n    privateKey: localCurve,\n    salt: salt,\n    authSecret: userAuth\n  });\n\n  return {\n    localPublicKey: localPublicKey,\n    salt: salt,\n    cipherText: cipherText\n  };\n};\n\nmodule.exports = {\n  encrypt: encrypt\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFjdGlvbi1icm93c2VyKS8uLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vd2ViLXB1c2hAMy42Ljcvbm9kZV9tb2R1bGVzL3dlYi1wdXNoL3NyYy9lbmNyeXB0aW9uLWhlbHBlci5qcyIsIm1hcHBpbmdzIjoiQUFBYTs7QUFFYixlQUFlLG1CQUFPLENBQUMsc0JBQVE7QUFDL0IsWUFBWSxtQkFBTyxDQUFDLHVHQUFVOztBQUU5QjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7O0FBRUg7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSIsInNvdXJjZXMiOlsiQzpcXERldlxcQ3Vyc29yV2ViQXBwVGVtcGxhdGVcXG5vZGVfbW9kdWxlc1xcLnBucG1cXHdlYi1wdXNoQDMuNi43XFxub2RlX21vZHVsZXNcXHdlYi1wdXNoXFxzcmNcXGVuY3J5cHRpb24taGVscGVyLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0JztcblxuY29uc3QgY3J5cHRvID0gcmVxdWlyZSgnY3J5cHRvJyk7XG5jb25zdCBlY2UgPSByZXF1aXJlKCdodHRwX2VjZScpO1xuXG5jb25zdCBlbmNyeXB0ID0gZnVuY3Rpb24odXNlclB1YmxpY0tleSwgdXNlckF1dGgsIHBheWxvYWQsIGNvbnRlbnRFbmNvZGluZykge1xuICBpZiAoIXVzZXJQdWJsaWNLZXkpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ05vIHVzZXIgcHVibGljIGtleSBwcm92aWRlZCBmb3IgZW5jcnlwdGlvbi4nKTtcbiAgfVxuXG4gIGlmICh0eXBlb2YgdXNlclB1YmxpY0tleSAhPT0gJ3N0cmluZycpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ1RoZSBzdWJzY3JpcHRpb24gcDI1NmRoIHZhbHVlIG11c3QgYmUgYSBzdHJpbmcuJyk7XG4gIH1cblxuICBpZiAoQnVmZmVyLmZyb20odXNlclB1YmxpY0tleSwgJ2Jhc2U2NHVybCcpLmxlbmd0aCAhPT0gNjUpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ1RoZSBzdWJzY3JpcHRpb24gcDI1NmRoIHZhbHVlIHNob3VsZCBiZSA2NSBieXRlcyBsb25nLicpO1xuICB9XG5cbiAgaWYgKCF1c2VyQXV0aCkge1xuICAgIHRocm93IG5ldyBFcnJvcignTm8gdXNlciBhdXRoIHByb3ZpZGVkIGZvciBlbmNyeXB0aW9uLicpO1xuICB9XG5cbiAgaWYgKHR5cGVvZiB1c2VyQXV0aCAhPT0gJ3N0cmluZycpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ1RoZSBzdWJzY3JpcHRpb24gYXV0aCBrZXkgbXVzdCBiZSBhIHN0cmluZy4nKTtcbiAgfVxuXG4gIGlmIChCdWZmZXIuZnJvbSh1c2VyQXV0aCwgJ2Jhc2U2NHVybCcpLmxlbmd0aCA8IDE2KSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdUaGUgc3Vic2NyaXB0aW9uIGF1dGgga2V5IHNob3VsZCBiZSBhdCBsZWFzdCAxNiAnXG4gICAgKyAnYnl0ZXMgbG9uZycpO1xuICB9XG5cbiAgaWYgKHR5cGVvZiBwYXlsb2FkICE9PSAnc3RyaW5nJyAmJiAhQnVmZmVyLmlzQnVmZmVyKHBheWxvYWQpKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdQYXlsb2FkIG11c3QgYmUgZWl0aGVyIGEgc3RyaW5nIG9yIGEgTm9kZSBCdWZmZXIuJyk7XG4gIH1cblxuICBpZiAodHlwZW9mIHBheWxvYWQgPT09ICdzdHJpbmcnIHx8IHBheWxvYWQgaW5zdGFuY2VvZiBTdHJpbmcpIHtcbiAgICBwYXlsb2FkID0gQnVmZmVyLmZyb20ocGF5bG9hZCk7XG4gIH1cblxuICBjb25zdCBsb2NhbEN1cnZlID0gY3J5cHRvLmNyZWF0ZUVDREgoJ3ByaW1lMjU2djEnKTtcbiAgY29uc3QgbG9jYWxQdWJsaWNLZXkgPSBsb2NhbEN1cnZlLmdlbmVyYXRlS2V5cygpO1xuXG4gIGNvbnN0IHNhbHQgPSBjcnlwdG8ucmFuZG9tQnl0ZXMoMTYpLnRvU3RyaW5nKCdiYXNlNjR1cmwnKTtcblxuICBjb25zdCBjaXBoZXJUZXh0ID0gZWNlLmVuY3J5cHQocGF5bG9hZCwge1xuICAgIHZlcnNpb246IGNvbnRlbnRFbmNvZGluZyxcbiAgICBkaDogdXNlclB1YmxpY0tleSxcbiAgICBwcml2YXRlS2V5OiBsb2NhbEN1cnZlLFxuICAgIHNhbHQ6IHNhbHQsXG4gICAgYXV0aFNlY3JldDogdXNlckF1dGhcbiAgfSk7XG5cbiAgcmV0dXJuIHtcbiAgICBsb2NhbFB1YmxpY0tleTogbG9jYWxQdWJsaWNLZXksXG4gICAgc2FsdDogc2FsdCxcbiAgICBjaXBoZXJUZXh0OiBjaXBoZXJUZXh0XG4gIH07XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IHtcbiAgZW5jcnlwdDogZW5jcnlwdFxufTtcbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(action-browser)/../../node_modules/.pnpm/web-push@3.6.7/node_modules/web-push/src/encryption-helper.js\n");

/***/ }),

/***/ "(action-browser)/../../node_modules/.pnpm/web-push@3.6.7/node_modules/web-push/src/index.js":
/*!**********************************************************************************!*\
  !*** ../../node_modules/.pnpm/web-push@3.6.7/node_modules/web-push/src/index.js ***!
  \**********************************************************************************/
/***/ ((module, __unused_webpack_exports, __webpack_require__) => {

eval("\n\nconst vapidHelper = __webpack_require__(/*! ./vapid-helper.js */ \"(action-browser)/../../node_modules/.pnpm/web-push@3.6.7/node_modules/web-push/src/vapid-helper.js\");\nconst encryptionHelper = __webpack_require__(/*! ./encryption-helper.js */ \"(action-browser)/../../node_modules/.pnpm/web-push@3.6.7/node_modules/web-push/src/encryption-helper.js\");\nconst WebPushLib = __webpack_require__(/*! ./web-push-lib.js */ \"(action-browser)/../../node_modules/.pnpm/web-push@3.6.7/node_modules/web-push/src/web-push-lib.js\");\nconst WebPushError = __webpack_require__(/*! ./web-push-error.js */ \"(action-browser)/../../node_modules/.pnpm/web-push@3.6.7/node_modules/web-push/src/web-push-error.js\");\nconst WebPushConstants = __webpack_require__(/*! ./web-push-constants.js */ \"(action-browser)/../../node_modules/.pnpm/web-push@3.6.7/node_modules/web-push/src/web-push-constants.js\");\n\nconst webPush = new WebPushLib();\n\nmodule.exports = {\n  WebPushError: WebPushError,\n  supportedContentEncodings: WebPushConstants.supportedContentEncodings,\n  encrypt: encryptionHelper.encrypt,\n  getVapidHeaders: vapidHelper.getVapidHeaders,\n  generateVAPIDKeys: vapidHelper.generateVAPIDKeys,\n  setGCMAPIKey: webPush.setGCMAPIKey,\n  setVapidDetails: webPush.setVapidDetails,\n  generateRequestDetails: webPush.generateRequestDetails,\n  sendNotification: webPush.sendNotification.bind(webPush)\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFjdGlvbi1icm93c2VyKS8uLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vd2ViLXB1c2hAMy42Ljcvbm9kZV9tb2R1bGVzL3dlYi1wdXNoL3NyYy9pbmRleC5qcyIsIm1hcHBpbmdzIjoiQUFBYTs7QUFFYixvQkFBb0IsbUJBQU8sQ0FBQyw2SEFBbUI7QUFDL0MseUJBQXlCLG1CQUFPLENBQUMsdUlBQXdCO0FBQ3pELG1CQUFtQixtQkFBTyxDQUFDLDZIQUFtQjtBQUM5QyxxQkFBcUIsbUJBQU8sQ0FBQyxpSUFBcUI7QUFDbEQseUJBQXlCLG1CQUFPLENBQUMseUlBQXlCOztBQUUxRDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlcyI6WyJDOlxcRGV2XFxDdXJzb3JXZWJBcHBUZW1wbGF0ZVxcbm9kZV9tb2R1bGVzXFwucG5wbVxcd2ViLXB1c2hAMy42LjdcXG5vZGVfbW9kdWxlc1xcd2ViLXB1c2hcXHNyY1xcaW5kZXguanMiXSwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xuXG5jb25zdCB2YXBpZEhlbHBlciA9IHJlcXVpcmUoJy4vdmFwaWQtaGVscGVyLmpzJyk7XG5jb25zdCBlbmNyeXB0aW9uSGVscGVyID0gcmVxdWlyZSgnLi9lbmNyeXB0aW9uLWhlbHBlci5qcycpO1xuY29uc3QgV2ViUHVzaExpYiA9IHJlcXVpcmUoJy4vd2ViLXB1c2gtbGliLmpzJyk7XG5jb25zdCBXZWJQdXNoRXJyb3IgPSByZXF1aXJlKCcuL3dlYi1wdXNoLWVycm9yLmpzJyk7XG5jb25zdCBXZWJQdXNoQ29uc3RhbnRzID0gcmVxdWlyZSgnLi93ZWItcHVzaC1jb25zdGFudHMuanMnKTtcblxuY29uc3Qgd2ViUHVzaCA9IG5ldyBXZWJQdXNoTGliKCk7XG5cbm1vZHVsZS5leHBvcnRzID0ge1xuICBXZWJQdXNoRXJyb3I6IFdlYlB1c2hFcnJvcixcbiAgc3VwcG9ydGVkQ29udGVudEVuY29kaW5nczogV2ViUHVzaENvbnN0YW50cy5zdXBwb3J0ZWRDb250ZW50RW5jb2RpbmdzLFxuICBlbmNyeXB0OiBlbmNyeXB0aW9uSGVscGVyLmVuY3J5cHQsXG4gIGdldFZhcGlkSGVhZGVyczogdmFwaWRIZWxwZXIuZ2V0VmFwaWRIZWFkZXJzLFxuICBnZW5lcmF0ZVZBUElES2V5czogdmFwaWRIZWxwZXIuZ2VuZXJhdGVWQVBJREtleXMsXG4gIHNldEdDTUFQSUtleTogd2ViUHVzaC5zZXRHQ01BUElLZXksXG4gIHNldFZhcGlkRGV0YWlsczogd2ViUHVzaC5zZXRWYXBpZERldGFpbHMsXG4gIGdlbmVyYXRlUmVxdWVzdERldGFpbHM6IHdlYlB1c2guZ2VuZXJhdGVSZXF1ZXN0RGV0YWlscyxcbiAgc2VuZE5vdGlmaWNhdGlvbjogd2ViUHVzaC5zZW5kTm90aWZpY2F0aW9uLmJpbmQod2ViUHVzaClcbn07XG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(action-browser)/../../node_modules/.pnpm/web-push@3.6.7/node_modules/web-push/src/index.js\n");

/***/ }),

/***/ "(action-browser)/../../node_modules/.pnpm/web-push@3.6.7/node_modules/web-push/src/urlsafe-base64-helper.js":
/*!**************************************************************************************************!*\
  !*** ../../node_modules/.pnpm/web-push@3.6.7/node_modules/web-push/src/urlsafe-base64-helper.js ***!
  \**************************************************************************************************/
/***/ ((module) => {

eval("\n\n/**\n * @param {string} base64\n * @returns {boolean}\n */\nfunction validate(base64) {\n  return /^[A-Za-z0-9\\-_]+$/.test(base64);\n}\n\nmodule.exports = {\n  validate: validate\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFjdGlvbi1icm93c2VyKS8uLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vd2ViLXB1c2hAMy42Ljcvbm9kZV9tb2R1bGVzL3dlYi1wdXNoL3NyYy91cmxzYWZlLWJhc2U2NC1oZWxwZXIuanMiLCJtYXBwaW5ncyI6IkFBQWE7O0FBRWI7QUFDQSxXQUFXLFFBQVE7QUFDbkIsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSIsInNvdXJjZXMiOlsiQzpcXERldlxcQ3Vyc29yV2ViQXBwVGVtcGxhdGVcXG5vZGVfbW9kdWxlc1xcLnBucG1cXHdlYi1wdXNoQDMuNi43XFxub2RlX21vZHVsZXNcXHdlYi1wdXNoXFxzcmNcXHVybHNhZmUtYmFzZTY0LWhlbHBlci5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCc7XG5cbi8qKlxuICogQHBhcmFtIHtzdHJpbmd9IGJhc2U2NFxuICogQHJldHVybnMge2Jvb2xlYW59XG4gKi9cbmZ1bmN0aW9uIHZhbGlkYXRlKGJhc2U2NCkge1xuICByZXR1cm4gL15bQS1aYS16MC05XFwtX10rJC8udGVzdChiYXNlNjQpO1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IHtcbiAgdmFsaWRhdGU6IHZhbGlkYXRlXG59O1xuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(action-browser)/../../node_modules/.pnpm/web-push@3.6.7/node_modules/web-push/src/urlsafe-base64-helper.js\n");

/***/ }),

/***/ "(action-browser)/../../node_modules/.pnpm/web-push@3.6.7/node_modules/web-push/src/vapid-helper.js":
/*!*****************************************************************************************!*\
  !*** ../../node_modules/.pnpm/web-push@3.6.7/node_modules/web-push/src/vapid-helper.js ***!
  \*****************************************************************************************/
/***/ ((module, __unused_webpack_exports, __webpack_require__) => {

eval("\n\nconst crypto = __webpack_require__(/*! crypto */ \"crypto\");\nconst asn1 = __webpack_require__(/*! asn1.js */ \"(action-browser)/../../node_modules/.pnpm/asn1.js@5.4.1/node_modules/asn1.js/lib/asn1.js\");\nconst jws = __webpack_require__(/*! jws */ \"(action-browser)/../../node_modules/.pnpm/jws@4.0.0/node_modules/jws/index.js\");\nconst { URL } = __webpack_require__(/*! url */ \"url\");\n\nconst WebPushConstants = __webpack_require__(/*! ./web-push-constants.js */ \"(action-browser)/../../node_modules/.pnpm/web-push@3.6.7/node_modules/web-push/src/web-push-constants.js\");\nconst urlBase64Helper = __webpack_require__(/*! ./urlsafe-base64-helper */ \"(action-browser)/../../node_modules/.pnpm/web-push@3.6.7/node_modules/web-push/src/urlsafe-base64-helper.js\");\n\n/**\n * DEFAULT_EXPIRATION is set to seconds in 12 hours\n */\nconst DEFAULT_EXPIRATION_SECONDS = 12 * 60 * 60;\n\n// Maximum expiration is 24 hours according. (See VAPID spec)\nconst MAX_EXPIRATION_SECONDS = 24 * 60 * 60;\n\nconst ECPrivateKeyASN = asn1.define('ECPrivateKey', function() {\n  this.seq().obj(\n    this.key('version').int(),\n    this.key('privateKey').octstr(),\n    this.key('parameters').explicit(0).objid()\n      .optional(),\n    this.key('publicKey').explicit(1).bitstr()\n      .optional()\n  );\n});\n\nfunction toPEM(key) {\n  return ECPrivateKeyASN.encode({\n    version: 1,\n    privateKey: key,\n    parameters: [1, 2, 840, 10045, 3, 1, 7] // prime256v1\n  }, 'pem', {\n    label: 'EC PRIVATE KEY'\n  });\n}\n\nfunction generateVAPIDKeys() {\n  const curve = crypto.createECDH('prime256v1');\n  curve.generateKeys();\n\n  let publicKeyBuffer = curve.getPublicKey();\n  let privateKeyBuffer = curve.getPrivateKey();\n\n  // Occassionally the keys will not be padded to the correct lengh resulting\n  // in errors, hence this padding.\n  // See https://github.com/web-push-libs/web-push/issues/295 for history.\n  if (privateKeyBuffer.length < 32) {\n    const padding = Buffer.alloc(32 - privateKeyBuffer.length);\n    padding.fill(0);\n    privateKeyBuffer = Buffer.concat([padding, privateKeyBuffer]);\n  }\n\n  if (publicKeyBuffer.length < 65) {\n    const padding = Buffer.alloc(65 - publicKeyBuffer.length);\n    padding.fill(0);\n    publicKeyBuffer = Buffer.concat([padding, publicKeyBuffer]);\n  }\n\n  return {\n    publicKey: publicKeyBuffer.toString('base64url'),\n    privateKey: privateKeyBuffer.toString('base64url')\n  };\n}\n\nfunction validateSubject(subject) {\n  if (!subject) {\n    throw new Error('No subject set in vapidDetails.subject.');\n  }\n\n  if (typeof subject !== 'string' || subject.length === 0) {\n    throw new Error('The subject value must be a string containing an https: URL or '\n    + 'mailto: address. ' + subject);\n  }\n\n  let subjectParseResult = null;\n  try {\n    subjectParseResult = new URL(subject);\n  } catch (err) {\n    throw new Error('Vapid subject is not a valid URL. ' + subject);\n  }\n  if (!['https:', 'mailto:'].includes(subjectParseResult.protocol)) {\n    throw new Error('Vapid subject is not an https: or mailto: URL. ' + subject);\n  }\n  if (subjectParseResult.hostname === 'localhost') {\n    console.warn('Vapid subject points to a localhost web URI, which is unsupported by '\n      + 'Apple\\'s push notification server and will result in a BadJwtToken error when '\n      + 'sending notifications.');\n    }\n}\n\nfunction validatePublicKey(publicKey) {\n  if (!publicKey) {\n    throw new Error('No key set vapidDetails.publicKey');\n  }\n\n  if (typeof publicKey !== 'string') {\n    throw new Error('Vapid public key is must be a URL safe Base 64 '\n    + 'encoded string.');\n  }\n\n  if (!urlBase64Helper.validate(publicKey)) {\n    throw new Error('Vapid public key must be a URL safe Base 64 (without \"=\")');\n  }\n\n  publicKey = Buffer.from(publicKey, 'base64url');\n\n  if (publicKey.length !== 65) {\n    throw new Error('Vapid public key should be 65 bytes long when decoded.');\n  }\n}\n\nfunction validatePrivateKey(privateKey) {\n  if (!privateKey) {\n    throw new Error('No key set in vapidDetails.privateKey');\n  }\n\n  if (typeof privateKey !== 'string') {\n    throw new Error('Vapid private key must be a URL safe Base 64 '\n    + 'encoded string.');\n  }\n\n  if (!urlBase64Helper.validate(privateKey)) {\n    throw new Error('Vapid private key must be a URL safe Base 64 (without \"=\")');\n  }\n\n  privateKey = Buffer.from(privateKey, 'base64url');\n\n  if (privateKey.length !== 32) {\n    throw new Error('Vapid private key should be 32 bytes long when decoded.');\n  }\n}\n\n/**\n * Given the number of seconds calculates\n * the expiration in the future by adding the passed `numSeconds`\n * with the current seconds from Unix Epoch\n *\n * @param {Number} numSeconds Number of seconds to be added\n * @return {Number} Future expiration in seconds\n */\nfunction getFutureExpirationTimestamp(numSeconds) {\n  const futureExp = new Date();\n  futureExp.setSeconds(futureExp.getSeconds() + numSeconds);\n  return Math.floor(futureExp.getTime() / 1000);\n}\n\n/**\n * Validates the Expiration Header based on the VAPID Spec\n * Throws error of type `Error` if the expiration is not validated\n *\n * @param {Number} expiration Expiration seconds from Epoch to be validated\n */\nfunction validateExpiration(expiration) {\n  if (!Number.isInteger(expiration)) {\n    throw new Error('`expiration` value must be a number');\n  }\n\n  if (expiration < 0) {\n    throw new Error('`expiration` must be a positive integer');\n  }\n\n  // Roughly checks the time of expiration, since the max expiration can be ahead\n  // of the time than at the moment the expiration was generated\n  const maxExpirationTimestamp = getFutureExpirationTimestamp(MAX_EXPIRATION_SECONDS);\n\n  if (expiration >= maxExpirationTimestamp) {\n    throw new Error('`expiration` value is greater than maximum of 24 hours');\n  }\n}\n\n/**\n * This method takes the required VAPID parameters and returns the required\n * header to be added to a Web Push Protocol Request.\n * @param  {string} audience        This must be the origin of the push service.\n * @param  {string} subject         This should be a URL or a 'mailto:' email\n * address.\n * @param  {string} publicKey       The VAPID public key.\n * @param  {string} privateKey      The VAPID private key.\n * @param  {string} contentEncoding The contentEncoding type.\n * @param  {integer} [expiration]   The expiration of the VAPID JWT.\n * @return {Object}                 Returns an Object with the Authorization and\n * 'Crypto-Key' values to be used as headers.\n */\nfunction getVapidHeaders(audience, subject, publicKey, privateKey, contentEncoding, expiration) {\n  if (!audience) {\n    throw new Error('No audience could be generated for VAPID.');\n  }\n\n  if (typeof audience !== 'string' || audience.length === 0) {\n    throw new Error('The audience value must be a string containing the '\n    + 'origin of a push service. ' + audience);\n  }\n\n  try {\n    new URL(audience); // eslint-disable-line no-new\n  } catch (err) {\n    throw new Error('VAPID audience is not a url. ' + audience);\n  }\n\n  validateSubject(subject);\n  validatePublicKey(publicKey);\n  validatePrivateKey(privateKey);\n\n  privateKey = Buffer.from(privateKey, 'base64url');\n\n  if (expiration) {\n    validateExpiration(expiration);\n  } else {\n    expiration = getFutureExpirationTimestamp(DEFAULT_EXPIRATION_SECONDS);\n  }\n\n  const header = {\n    typ: 'JWT',\n    alg: 'ES256'\n  };\n\n  const jwtPayload = {\n    aud: audience,\n    exp: expiration,\n    sub: subject\n  };\n\n  const jwt = jws.sign({\n    header: header,\n    payload: jwtPayload,\n    privateKey: toPEM(privateKey)\n  });\n\n  if (contentEncoding === WebPushConstants.supportedContentEncodings.AES_128_GCM) {\n    return {\n      Authorization: 'vapid t=' + jwt + ', k=' + publicKey\n    };\n  }\n  if (contentEncoding === WebPushConstants.supportedContentEncodings.AES_GCM) {\n    return {\n      Authorization: 'WebPush ' + jwt,\n      'Crypto-Key': 'p256ecdsa=' + publicKey\n    };\n  }\n\n  throw new Error('Unsupported encoding type specified.');\n}\n\nmodule.exports = {\n  generateVAPIDKeys: generateVAPIDKeys,\n  getFutureExpirationTimestamp: getFutureExpirationTimestamp,\n  getVapidHeaders: getVapidHeaders,\n  validateSubject: validateSubject,\n  validatePublicKey: validatePublicKey,\n  validatePrivateKey: validatePrivateKey,\n  validateExpiration: validateExpiration\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFjdGlvbi1icm93c2VyKS8uLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vd2ViLXB1c2hAMy42Ljcvbm9kZV9tb2R1bGVzL3dlYi1wdXNoL3NyYy92YXBpZC1oZWxwZXIuanMiLCJtYXBwaW5ncyI6IkFBQWE7O0FBRWIsZUFBZSxtQkFBTyxDQUFDLHNCQUFRO0FBQy9CLGFBQWEsbUJBQU8sQ0FBQyx5R0FBUztBQUM5QixZQUFZLG1CQUFPLENBQUMsMEZBQUs7QUFDekIsUUFBUSxNQUFNLEVBQUUsbUJBQU8sQ0FBQyxnQkFBSzs7QUFFN0IseUJBQXlCLG1CQUFPLENBQUMseUlBQXlCO0FBQzFELHdCQUF3QixtQkFBTyxDQUFDLDRJQUF5Qjs7QUFFekQ7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDOztBQUVEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQSxHQUFHO0FBQ0g7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVyxRQUFRO0FBQ25CLFlBQVksUUFBUTtBQUNwQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXLFFBQVE7QUFDbkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLFlBQVksUUFBUTtBQUNwQixZQUFZLFFBQVE7QUFDcEI7QUFDQSxZQUFZLFFBQVE7QUFDcEIsWUFBWSxRQUFRO0FBQ3BCLFlBQVksUUFBUTtBQUNwQixZQUFZLFNBQVM7QUFDckIsWUFBWSx3QkFBd0I7QUFDcEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsdUJBQXVCO0FBQ3ZCLElBQUk7QUFDSjtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7O0FBRUg7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZXMiOlsiQzpcXERldlxcQ3Vyc29yV2ViQXBwVGVtcGxhdGVcXG5vZGVfbW9kdWxlc1xcLnBucG1cXHdlYi1wdXNoQDMuNi43XFxub2RlX21vZHVsZXNcXHdlYi1wdXNoXFxzcmNcXHZhcGlkLWhlbHBlci5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCc7XG5cbmNvbnN0IGNyeXB0byA9IHJlcXVpcmUoJ2NyeXB0bycpO1xuY29uc3QgYXNuMSA9IHJlcXVpcmUoJ2FzbjEuanMnKTtcbmNvbnN0IGp3cyA9IHJlcXVpcmUoJ2p3cycpO1xuY29uc3QgeyBVUkwgfSA9IHJlcXVpcmUoJ3VybCcpO1xuXG5jb25zdCBXZWJQdXNoQ29uc3RhbnRzID0gcmVxdWlyZSgnLi93ZWItcHVzaC1jb25zdGFudHMuanMnKTtcbmNvbnN0IHVybEJhc2U2NEhlbHBlciA9IHJlcXVpcmUoJy4vdXJsc2FmZS1iYXNlNjQtaGVscGVyJyk7XG5cbi8qKlxuICogREVGQVVMVF9FWFBJUkFUSU9OIGlzIHNldCB0byBzZWNvbmRzIGluIDEyIGhvdXJzXG4gKi9cbmNvbnN0IERFRkFVTFRfRVhQSVJBVElPTl9TRUNPTkRTID0gMTIgKiA2MCAqIDYwO1xuXG4vLyBNYXhpbXVtIGV4cGlyYXRpb24gaXMgMjQgaG91cnMgYWNjb3JkaW5nLiAoU2VlIFZBUElEIHNwZWMpXG5jb25zdCBNQVhfRVhQSVJBVElPTl9TRUNPTkRTID0gMjQgKiA2MCAqIDYwO1xuXG5jb25zdCBFQ1ByaXZhdGVLZXlBU04gPSBhc24xLmRlZmluZSgnRUNQcml2YXRlS2V5JywgZnVuY3Rpb24oKSB7XG4gIHRoaXMuc2VxKCkub2JqKFxuICAgIHRoaXMua2V5KCd2ZXJzaW9uJykuaW50KCksXG4gICAgdGhpcy5rZXkoJ3ByaXZhdGVLZXknKS5vY3RzdHIoKSxcbiAgICB0aGlzLmtleSgncGFyYW1ldGVycycpLmV4cGxpY2l0KDApLm9iamlkKClcbiAgICAgIC5vcHRpb25hbCgpLFxuICAgIHRoaXMua2V5KCdwdWJsaWNLZXknKS5leHBsaWNpdCgxKS5iaXRzdHIoKVxuICAgICAgLm9wdGlvbmFsKClcbiAgKTtcbn0pO1xuXG5mdW5jdGlvbiB0b1BFTShrZXkpIHtcbiAgcmV0dXJuIEVDUHJpdmF0ZUtleUFTTi5lbmNvZGUoe1xuICAgIHZlcnNpb246IDEsXG4gICAgcHJpdmF0ZUtleToga2V5LFxuICAgIHBhcmFtZXRlcnM6IFsxLCAyLCA4NDAsIDEwMDQ1LCAzLCAxLCA3XSAvLyBwcmltZTI1NnYxXG4gIH0sICdwZW0nLCB7XG4gICAgbGFiZWw6ICdFQyBQUklWQVRFIEtFWSdcbiAgfSk7XG59XG5cbmZ1bmN0aW9uIGdlbmVyYXRlVkFQSURLZXlzKCkge1xuICBjb25zdCBjdXJ2ZSA9IGNyeXB0by5jcmVhdGVFQ0RIKCdwcmltZTI1NnYxJyk7XG4gIGN1cnZlLmdlbmVyYXRlS2V5cygpO1xuXG4gIGxldCBwdWJsaWNLZXlCdWZmZXIgPSBjdXJ2ZS5nZXRQdWJsaWNLZXkoKTtcbiAgbGV0IHByaXZhdGVLZXlCdWZmZXIgPSBjdXJ2ZS5nZXRQcml2YXRlS2V5KCk7XG5cbiAgLy8gT2NjYXNzaW9uYWxseSB0aGUga2V5cyB3aWxsIG5vdCBiZSBwYWRkZWQgdG8gdGhlIGNvcnJlY3QgbGVuZ2ggcmVzdWx0aW5nXG4gIC8vIGluIGVycm9ycywgaGVuY2UgdGhpcyBwYWRkaW5nLlxuICAvLyBTZWUgaHR0cHM6Ly9naXRodWIuY29tL3dlYi1wdXNoLWxpYnMvd2ViLXB1c2gvaXNzdWVzLzI5NSBmb3IgaGlzdG9yeS5cbiAgaWYgKHByaXZhdGVLZXlCdWZmZXIubGVuZ3RoIDwgMzIpIHtcbiAgICBjb25zdCBwYWRkaW5nID0gQnVmZmVyLmFsbG9jKDMyIC0gcHJpdmF0ZUtleUJ1ZmZlci5sZW5ndGgpO1xuICAgIHBhZGRpbmcuZmlsbCgwKTtcbiAgICBwcml2YXRlS2V5QnVmZmVyID0gQnVmZmVyLmNvbmNhdChbcGFkZGluZywgcHJpdmF0ZUtleUJ1ZmZlcl0pO1xuICB9XG5cbiAgaWYgKHB1YmxpY0tleUJ1ZmZlci5sZW5ndGggPCA2NSkge1xuICAgIGNvbnN0IHBhZGRpbmcgPSBCdWZmZXIuYWxsb2MoNjUgLSBwdWJsaWNLZXlCdWZmZXIubGVuZ3RoKTtcbiAgICBwYWRkaW5nLmZpbGwoMCk7XG4gICAgcHVibGljS2V5QnVmZmVyID0gQnVmZmVyLmNvbmNhdChbcGFkZGluZywgcHVibGljS2V5QnVmZmVyXSk7XG4gIH1cblxuICByZXR1cm4ge1xuICAgIHB1YmxpY0tleTogcHVibGljS2V5QnVmZmVyLnRvU3RyaW5nKCdiYXNlNjR1cmwnKSxcbiAgICBwcml2YXRlS2V5OiBwcml2YXRlS2V5QnVmZmVyLnRvU3RyaW5nKCdiYXNlNjR1cmwnKVxuICB9O1xufVxuXG5mdW5jdGlvbiB2YWxpZGF0ZVN1YmplY3Qoc3ViamVjdCkge1xuICBpZiAoIXN1YmplY3QpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ05vIHN1YmplY3Qgc2V0IGluIHZhcGlkRGV0YWlscy5zdWJqZWN0LicpO1xuICB9XG5cbiAgaWYgKHR5cGVvZiBzdWJqZWN0ICE9PSAnc3RyaW5nJyB8fCBzdWJqZWN0Lmxlbmd0aCA9PT0gMCkge1xuICAgIHRocm93IG5ldyBFcnJvcignVGhlIHN1YmplY3QgdmFsdWUgbXVzdCBiZSBhIHN0cmluZyBjb250YWluaW5nIGFuIGh0dHBzOiBVUkwgb3IgJ1xuICAgICsgJ21haWx0bzogYWRkcmVzcy4gJyArIHN1YmplY3QpO1xuICB9XG5cbiAgbGV0IHN1YmplY3RQYXJzZVJlc3VsdCA9IG51bGw7XG4gIHRyeSB7XG4gICAgc3ViamVjdFBhcnNlUmVzdWx0ID0gbmV3IFVSTChzdWJqZWN0KTtcbiAgfSBjYXRjaCAoZXJyKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdWYXBpZCBzdWJqZWN0IGlzIG5vdCBhIHZhbGlkIFVSTC4gJyArIHN1YmplY3QpO1xuICB9XG4gIGlmICghWydodHRwczonLCAnbWFpbHRvOiddLmluY2x1ZGVzKHN1YmplY3RQYXJzZVJlc3VsdC5wcm90b2NvbCkpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ1ZhcGlkIHN1YmplY3QgaXMgbm90IGFuIGh0dHBzOiBvciBtYWlsdG86IFVSTC4gJyArIHN1YmplY3QpO1xuICB9XG4gIGlmIChzdWJqZWN0UGFyc2VSZXN1bHQuaG9zdG5hbWUgPT09ICdsb2NhbGhvc3QnKSB7XG4gICAgY29uc29sZS53YXJuKCdWYXBpZCBzdWJqZWN0IHBvaW50cyB0byBhIGxvY2FsaG9zdCB3ZWIgVVJJLCB3aGljaCBpcyB1bnN1cHBvcnRlZCBieSAnXG4gICAgICArICdBcHBsZVxcJ3MgcHVzaCBub3RpZmljYXRpb24gc2VydmVyIGFuZCB3aWxsIHJlc3VsdCBpbiBhIEJhZEp3dFRva2VuIGVycm9yIHdoZW4gJ1xuICAgICAgKyAnc2VuZGluZyBub3RpZmljYXRpb25zLicpO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gdmFsaWRhdGVQdWJsaWNLZXkocHVibGljS2V5KSB7XG4gIGlmICghcHVibGljS2V5KSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdObyBrZXkgc2V0IHZhcGlkRGV0YWlscy5wdWJsaWNLZXknKTtcbiAgfVxuXG4gIGlmICh0eXBlb2YgcHVibGljS2V5ICE9PSAnc3RyaW5nJykge1xuICAgIHRocm93IG5ldyBFcnJvcignVmFwaWQgcHVibGljIGtleSBpcyBtdXN0IGJlIGEgVVJMIHNhZmUgQmFzZSA2NCAnXG4gICAgKyAnZW5jb2RlZCBzdHJpbmcuJyk7XG4gIH1cblxuICBpZiAoIXVybEJhc2U2NEhlbHBlci52YWxpZGF0ZShwdWJsaWNLZXkpKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdWYXBpZCBwdWJsaWMga2V5IG11c3QgYmUgYSBVUkwgc2FmZSBCYXNlIDY0ICh3aXRob3V0IFwiPVwiKScpO1xuICB9XG5cbiAgcHVibGljS2V5ID0gQnVmZmVyLmZyb20ocHVibGljS2V5LCAnYmFzZTY0dXJsJyk7XG5cbiAgaWYgKHB1YmxpY0tleS5sZW5ndGggIT09IDY1KSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdWYXBpZCBwdWJsaWMga2V5IHNob3VsZCBiZSA2NSBieXRlcyBsb25nIHdoZW4gZGVjb2RlZC4nKTtcbiAgfVxufVxuXG5mdW5jdGlvbiB2YWxpZGF0ZVByaXZhdGVLZXkocHJpdmF0ZUtleSkge1xuICBpZiAoIXByaXZhdGVLZXkpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ05vIGtleSBzZXQgaW4gdmFwaWREZXRhaWxzLnByaXZhdGVLZXknKTtcbiAgfVxuXG4gIGlmICh0eXBlb2YgcHJpdmF0ZUtleSAhPT0gJ3N0cmluZycpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ1ZhcGlkIHByaXZhdGUga2V5IG11c3QgYmUgYSBVUkwgc2FmZSBCYXNlIDY0ICdcbiAgICArICdlbmNvZGVkIHN0cmluZy4nKTtcbiAgfVxuXG4gIGlmICghdXJsQmFzZTY0SGVscGVyLnZhbGlkYXRlKHByaXZhdGVLZXkpKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdWYXBpZCBwcml2YXRlIGtleSBtdXN0IGJlIGEgVVJMIHNhZmUgQmFzZSA2NCAod2l0aG91dCBcIj1cIiknKTtcbiAgfVxuXG4gIHByaXZhdGVLZXkgPSBCdWZmZXIuZnJvbShwcml2YXRlS2V5LCAnYmFzZTY0dXJsJyk7XG5cbiAgaWYgKHByaXZhdGVLZXkubGVuZ3RoICE9PSAzMikge1xuICAgIHRocm93IG5ldyBFcnJvcignVmFwaWQgcHJpdmF0ZSBrZXkgc2hvdWxkIGJlIDMyIGJ5dGVzIGxvbmcgd2hlbiBkZWNvZGVkLicpO1xuICB9XG59XG5cbi8qKlxuICogR2l2ZW4gdGhlIG51bWJlciBvZiBzZWNvbmRzIGNhbGN1bGF0ZXNcbiAqIHRoZSBleHBpcmF0aW9uIGluIHRoZSBmdXR1cmUgYnkgYWRkaW5nIHRoZSBwYXNzZWQgYG51bVNlY29uZHNgXG4gKiB3aXRoIHRoZSBjdXJyZW50IHNlY29uZHMgZnJvbSBVbml4IEVwb2NoXG4gKlxuICogQHBhcmFtIHtOdW1iZXJ9IG51bVNlY29uZHMgTnVtYmVyIG9mIHNlY29uZHMgdG8gYmUgYWRkZWRcbiAqIEByZXR1cm4ge051bWJlcn0gRnV0dXJlIGV4cGlyYXRpb24gaW4gc2Vjb25kc1xuICovXG5mdW5jdGlvbiBnZXRGdXR1cmVFeHBpcmF0aW9uVGltZXN0YW1wKG51bVNlY29uZHMpIHtcbiAgY29uc3QgZnV0dXJlRXhwID0gbmV3IERhdGUoKTtcbiAgZnV0dXJlRXhwLnNldFNlY29uZHMoZnV0dXJlRXhwLmdldFNlY29uZHMoKSArIG51bVNlY29uZHMpO1xuICByZXR1cm4gTWF0aC5mbG9vcihmdXR1cmVFeHAuZ2V0VGltZSgpIC8gMTAwMCk7XG59XG5cbi8qKlxuICogVmFsaWRhdGVzIHRoZSBFeHBpcmF0aW9uIEhlYWRlciBiYXNlZCBvbiB0aGUgVkFQSUQgU3BlY1xuICogVGhyb3dzIGVycm9yIG9mIHR5cGUgYEVycm9yYCBpZiB0aGUgZXhwaXJhdGlvbiBpcyBub3QgdmFsaWRhdGVkXG4gKlxuICogQHBhcmFtIHtOdW1iZXJ9IGV4cGlyYXRpb24gRXhwaXJhdGlvbiBzZWNvbmRzIGZyb20gRXBvY2ggdG8gYmUgdmFsaWRhdGVkXG4gKi9cbmZ1bmN0aW9uIHZhbGlkYXRlRXhwaXJhdGlvbihleHBpcmF0aW9uKSB7XG4gIGlmICghTnVtYmVyLmlzSW50ZWdlcihleHBpcmF0aW9uKSkge1xuICAgIHRocm93IG5ldyBFcnJvcignYGV4cGlyYXRpb25gIHZhbHVlIG11c3QgYmUgYSBudW1iZXInKTtcbiAgfVxuXG4gIGlmIChleHBpcmF0aW9uIDwgMCkge1xuICAgIHRocm93IG5ldyBFcnJvcignYGV4cGlyYXRpb25gIG11c3QgYmUgYSBwb3NpdGl2ZSBpbnRlZ2VyJyk7XG4gIH1cblxuICAvLyBSb3VnaGx5IGNoZWNrcyB0aGUgdGltZSBvZiBleHBpcmF0aW9uLCBzaW5jZSB0aGUgbWF4IGV4cGlyYXRpb24gY2FuIGJlIGFoZWFkXG4gIC8vIG9mIHRoZSB0aW1lIHRoYW4gYXQgdGhlIG1vbWVudCB0aGUgZXhwaXJhdGlvbiB3YXMgZ2VuZXJhdGVkXG4gIGNvbnN0IG1heEV4cGlyYXRpb25UaW1lc3RhbXAgPSBnZXRGdXR1cmVFeHBpcmF0aW9uVGltZXN0YW1wKE1BWF9FWFBJUkFUSU9OX1NFQ09ORFMpO1xuXG4gIGlmIChleHBpcmF0aW9uID49IG1heEV4cGlyYXRpb25UaW1lc3RhbXApIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ2BleHBpcmF0aW9uYCB2YWx1ZSBpcyBncmVhdGVyIHRoYW4gbWF4aW11bSBvZiAyNCBob3VycycpO1xuICB9XG59XG5cbi8qKlxuICogVGhpcyBtZXRob2QgdGFrZXMgdGhlIHJlcXVpcmVkIFZBUElEIHBhcmFtZXRlcnMgYW5kIHJldHVybnMgdGhlIHJlcXVpcmVkXG4gKiBoZWFkZXIgdG8gYmUgYWRkZWQgdG8gYSBXZWIgUHVzaCBQcm90b2NvbCBSZXF1ZXN0LlxuICogQHBhcmFtICB7c3RyaW5nfSBhdWRpZW5jZSAgICAgICAgVGhpcyBtdXN0IGJlIHRoZSBvcmlnaW4gb2YgdGhlIHB1c2ggc2VydmljZS5cbiAqIEBwYXJhbSAge3N0cmluZ30gc3ViamVjdCAgICAgICAgIFRoaXMgc2hvdWxkIGJlIGEgVVJMIG9yIGEgJ21haWx0bzonIGVtYWlsXG4gKiBhZGRyZXNzLlxuICogQHBhcmFtICB7c3RyaW5nfSBwdWJsaWNLZXkgICAgICAgVGhlIFZBUElEIHB1YmxpYyBrZXkuXG4gKiBAcGFyYW0gIHtzdHJpbmd9IHByaXZhdGVLZXkgICAgICBUaGUgVkFQSUQgcHJpdmF0ZSBrZXkuXG4gKiBAcGFyYW0gIHtzdHJpbmd9IGNvbnRlbnRFbmNvZGluZyBUaGUgY29udGVudEVuY29kaW5nIHR5cGUuXG4gKiBAcGFyYW0gIHtpbnRlZ2VyfSBbZXhwaXJhdGlvbl0gICBUaGUgZXhwaXJhdGlvbiBvZiB0aGUgVkFQSUQgSldULlxuICogQHJldHVybiB7T2JqZWN0fSAgICAgICAgICAgICAgICAgUmV0dXJucyBhbiBPYmplY3Qgd2l0aCB0aGUgQXV0aG9yaXphdGlvbiBhbmRcbiAqICdDcnlwdG8tS2V5JyB2YWx1ZXMgdG8gYmUgdXNlZCBhcyBoZWFkZXJzLlxuICovXG5mdW5jdGlvbiBnZXRWYXBpZEhlYWRlcnMoYXVkaWVuY2UsIHN1YmplY3QsIHB1YmxpY0tleSwgcHJpdmF0ZUtleSwgY29udGVudEVuY29kaW5nLCBleHBpcmF0aW9uKSB7XG4gIGlmICghYXVkaWVuY2UpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ05vIGF1ZGllbmNlIGNvdWxkIGJlIGdlbmVyYXRlZCBmb3IgVkFQSUQuJyk7XG4gIH1cblxuICBpZiAodHlwZW9mIGF1ZGllbmNlICE9PSAnc3RyaW5nJyB8fCBhdWRpZW5jZS5sZW5ndGggPT09IDApIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ1RoZSBhdWRpZW5jZSB2YWx1ZSBtdXN0IGJlIGEgc3RyaW5nIGNvbnRhaW5pbmcgdGhlICdcbiAgICArICdvcmlnaW4gb2YgYSBwdXNoIHNlcnZpY2UuICcgKyBhdWRpZW5jZSk7XG4gIH1cblxuICB0cnkge1xuICAgIG5ldyBVUkwoYXVkaWVuY2UpOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLW5ld1xuICB9IGNhdGNoIChlcnIpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ1ZBUElEIGF1ZGllbmNlIGlzIG5vdCBhIHVybC4gJyArIGF1ZGllbmNlKTtcbiAgfVxuXG4gIHZhbGlkYXRlU3ViamVjdChzdWJqZWN0KTtcbiAgdmFsaWRhdGVQdWJsaWNLZXkocHVibGljS2V5KTtcbiAgdmFsaWRhdGVQcml2YXRlS2V5KHByaXZhdGVLZXkpO1xuXG4gIHByaXZhdGVLZXkgPSBCdWZmZXIuZnJvbShwcml2YXRlS2V5LCAnYmFzZTY0dXJsJyk7XG5cbiAgaWYgKGV4cGlyYXRpb24pIHtcbiAgICB2YWxpZGF0ZUV4cGlyYXRpb24oZXhwaXJhdGlvbik7XG4gIH0gZWxzZSB7XG4gICAgZXhwaXJhdGlvbiA9IGdldEZ1dHVyZUV4cGlyYXRpb25UaW1lc3RhbXAoREVGQVVMVF9FWFBJUkFUSU9OX1NFQ09ORFMpO1xuICB9XG5cbiAgY29uc3QgaGVhZGVyID0ge1xuICAgIHR5cDogJ0pXVCcsXG4gICAgYWxnOiAnRVMyNTYnXG4gIH07XG5cbiAgY29uc3Qgand0UGF5bG9hZCA9IHtcbiAgICBhdWQ6IGF1ZGllbmNlLFxuICAgIGV4cDogZXhwaXJhdGlvbixcbiAgICBzdWI6IHN1YmplY3RcbiAgfTtcblxuICBjb25zdCBqd3QgPSBqd3Muc2lnbih7XG4gICAgaGVhZGVyOiBoZWFkZXIsXG4gICAgcGF5bG9hZDogand0UGF5bG9hZCxcbiAgICBwcml2YXRlS2V5OiB0b1BFTShwcml2YXRlS2V5KVxuICB9KTtcblxuICBpZiAoY29udGVudEVuY29kaW5nID09PSBXZWJQdXNoQ29uc3RhbnRzLnN1cHBvcnRlZENvbnRlbnRFbmNvZGluZ3MuQUVTXzEyOF9HQ00pIHtcbiAgICByZXR1cm4ge1xuICAgICAgQXV0aG9yaXphdGlvbjogJ3ZhcGlkIHQ9JyArIGp3dCArICcsIGs9JyArIHB1YmxpY0tleVxuICAgIH07XG4gIH1cbiAgaWYgKGNvbnRlbnRFbmNvZGluZyA9PT0gV2ViUHVzaENvbnN0YW50cy5zdXBwb3J0ZWRDb250ZW50RW5jb2RpbmdzLkFFU19HQ00pIHtcbiAgICByZXR1cm4ge1xuICAgICAgQXV0aG9yaXphdGlvbjogJ1dlYlB1c2ggJyArIGp3dCxcbiAgICAgICdDcnlwdG8tS2V5JzogJ3AyNTZlY2RzYT0nICsgcHVibGljS2V5XG4gICAgfTtcbiAgfVxuXG4gIHRocm93IG5ldyBFcnJvcignVW5zdXBwb3J0ZWQgZW5jb2RpbmcgdHlwZSBzcGVjaWZpZWQuJyk7XG59XG5cbm1vZHVsZS5leHBvcnRzID0ge1xuICBnZW5lcmF0ZVZBUElES2V5czogZ2VuZXJhdGVWQVBJREtleXMsXG4gIGdldEZ1dHVyZUV4cGlyYXRpb25UaW1lc3RhbXA6IGdldEZ1dHVyZUV4cGlyYXRpb25UaW1lc3RhbXAsXG4gIGdldFZhcGlkSGVhZGVyczogZ2V0VmFwaWRIZWFkZXJzLFxuICB2YWxpZGF0ZVN1YmplY3Q6IHZhbGlkYXRlU3ViamVjdCxcbiAgdmFsaWRhdGVQdWJsaWNLZXk6IHZhbGlkYXRlUHVibGljS2V5LFxuICB2YWxpZGF0ZVByaXZhdGVLZXk6IHZhbGlkYXRlUHJpdmF0ZUtleSxcbiAgdmFsaWRhdGVFeHBpcmF0aW9uOiB2YWxpZGF0ZUV4cGlyYXRpb25cbn07XG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(action-browser)/../../node_modules/.pnpm/web-push@3.6.7/node_modules/web-push/src/vapid-helper.js\n");

/***/ }),

/***/ "(action-browser)/../../node_modules/.pnpm/web-push@3.6.7/node_modules/web-push/src/web-push-constants.js":
/*!***********************************************************************************************!*\
  !*** ../../node_modules/.pnpm/web-push@3.6.7/node_modules/web-push/src/web-push-constants.js ***!
  \***********************************************************************************************/
/***/ ((module) => {

eval("\n\nconst WebPushConstants = {};\n\nWebPushConstants.supportedContentEncodings = {\n  AES_GCM: 'aesgcm',\n  AES_128_GCM: 'aes128gcm'\n};\n\nWebPushConstants.supportedUrgency = {\n  VERY_LOW: 'very-low',\n  LOW: 'low',\n  NORMAL: 'normal',\n  HIGH: 'high'\n};\n\nmodule.exports = WebPushConstants;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFjdGlvbi1icm93c2VyKS8uLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vd2ViLXB1c2hAMy42Ljcvbm9kZV9tb2R1bGVzL3dlYi1wdXNoL3NyYy93ZWItcHVzaC1jb25zdGFudHMuanMiLCJtYXBwaW5ncyI6IkFBQWE7O0FBRWI7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBIiwic291cmNlcyI6WyJDOlxcRGV2XFxDdXJzb3JXZWJBcHBUZW1wbGF0ZVxcbm9kZV9tb2R1bGVzXFwucG5wbVxcd2ViLXB1c2hAMy42LjdcXG5vZGVfbW9kdWxlc1xcd2ViLXB1c2hcXHNyY1xcd2ViLXB1c2gtY29uc3RhbnRzLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0JztcblxuY29uc3QgV2ViUHVzaENvbnN0YW50cyA9IHt9O1xuXG5XZWJQdXNoQ29uc3RhbnRzLnN1cHBvcnRlZENvbnRlbnRFbmNvZGluZ3MgPSB7XG4gIEFFU19HQ006ICdhZXNnY20nLFxuICBBRVNfMTI4X0dDTTogJ2FlczEyOGdjbSdcbn07XG5cbldlYlB1c2hDb25zdGFudHMuc3VwcG9ydGVkVXJnZW5jeSA9IHtcbiAgVkVSWV9MT1c6ICd2ZXJ5LWxvdycsXG4gIExPVzogJ2xvdycsXG4gIE5PUk1BTDogJ25vcm1hbCcsXG4gIEhJR0g6ICdoaWdoJ1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBXZWJQdXNoQ29uc3RhbnRzO1xuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(action-browser)/../../node_modules/.pnpm/web-push@3.6.7/node_modules/web-push/src/web-push-constants.js\n");

/***/ }),

/***/ "(action-browser)/../../node_modules/.pnpm/web-push@3.6.7/node_modules/web-push/src/web-push-error.js":
/*!*******************************************************************************************!*\
  !*** ../../node_modules/.pnpm/web-push@3.6.7/node_modules/web-push/src/web-push-error.js ***!
  \*******************************************************************************************/
/***/ ((module, __unused_webpack_exports, __webpack_require__) => {

eval("\n\nfunction WebPushError(message, statusCode, headers, body, endpoint) {\n  Error.captureStackTrace(this, this.constructor);\n\n  this.name = this.constructor.name;\n  this.message = message;\n  this.statusCode = statusCode;\n  this.headers = headers;\n  this.body = body;\n  this.endpoint = endpoint;\n}\n\n(__webpack_require__(/*! util */ \"util\").inherits)(WebPushError, Error);\n\nmodule.exports = WebPushError;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFjdGlvbi1icm93c2VyKS8uLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vd2ViLXB1c2hAMy42Ljcvbm9kZV9tb2R1bGVzL3dlYi1wdXNoL3NyYy93ZWItcHVzaC1lcnJvci5qcyIsIm1hcHBpbmdzIjoiQUFBYTs7QUFFYjtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLGtEQUF3Qjs7QUFFeEIiLCJzb3VyY2VzIjpbIkM6XFxEZXZcXEN1cnNvcldlYkFwcFRlbXBsYXRlXFxub2RlX21vZHVsZXNcXC5wbnBtXFx3ZWItcHVzaEAzLjYuN1xcbm9kZV9tb2R1bGVzXFx3ZWItcHVzaFxcc3JjXFx3ZWItcHVzaC1lcnJvci5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCc7XG5cbmZ1bmN0aW9uIFdlYlB1c2hFcnJvcihtZXNzYWdlLCBzdGF0dXNDb2RlLCBoZWFkZXJzLCBib2R5LCBlbmRwb2ludCkge1xuICBFcnJvci5jYXB0dXJlU3RhY2tUcmFjZSh0aGlzLCB0aGlzLmNvbnN0cnVjdG9yKTtcblxuICB0aGlzLm5hbWUgPSB0aGlzLmNvbnN0cnVjdG9yLm5hbWU7XG4gIHRoaXMubWVzc2FnZSA9IG1lc3NhZ2U7XG4gIHRoaXMuc3RhdHVzQ29kZSA9IHN0YXR1c0NvZGU7XG4gIHRoaXMuaGVhZGVycyA9IGhlYWRlcnM7XG4gIHRoaXMuYm9keSA9IGJvZHk7XG4gIHRoaXMuZW5kcG9pbnQgPSBlbmRwb2ludDtcbn1cblxucmVxdWlyZSgndXRpbCcpLmluaGVyaXRzKFdlYlB1c2hFcnJvciwgRXJyb3IpO1xuXG5tb2R1bGUuZXhwb3J0cyA9IFdlYlB1c2hFcnJvcjtcbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(action-browser)/../../node_modules/.pnpm/web-push@3.6.7/node_modules/web-push/src/web-push-error.js\n");

/***/ }),

/***/ "(action-browser)/../../node_modules/.pnpm/web-push@3.6.7/node_modules/web-push/src/web-push-lib.js":
/*!*****************************************************************************************!*\
  !*** ../../node_modules/.pnpm/web-push@3.6.7/node_modules/web-push/src/web-push-lib.js ***!
  \*****************************************************************************************/
/***/ ((module, __unused_webpack_exports, __webpack_require__) => {

eval("\n\nconst url = __webpack_require__(/*! url */ \"url\");\nconst https = __webpack_require__(/*! https */ \"https\");\n\nconst WebPushError = __webpack_require__(/*! ./web-push-error.js */ \"(action-browser)/../../node_modules/.pnpm/web-push@3.6.7/node_modules/web-push/src/web-push-error.js\");\nconst vapidHelper = __webpack_require__(/*! ./vapid-helper.js */ \"(action-browser)/../../node_modules/.pnpm/web-push@3.6.7/node_modules/web-push/src/vapid-helper.js\");\nconst encryptionHelper = __webpack_require__(/*! ./encryption-helper.js */ \"(action-browser)/../../node_modules/.pnpm/web-push@3.6.7/node_modules/web-push/src/encryption-helper.js\");\nconst webPushConstants = __webpack_require__(/*! ./web-push-constants.js */ \"(action-browser)/../../node_modules/.pnpm/web-push@3.6.7/node_modules/web-push/src/web-push-constants.js\");\nconst urlBase64Helper = __webpack_require__(/*! ./urlsafe-base64-helper */ \"(action-browser)/../../node_modules/.pnpm/web-push@3.6.7/node_modules/web-push/src/urlsafe-base64-helper.js\");\n\n// Default TTL is four weeks.\nconst DEFAULT_TTL = 2419200;\n\nlet gcmAPIKey = '';\nlet vapidDetails;\n\nfunction WebPushLib() {\n\n}\n\n/**\n * When sending messages to a GCM endpoint you need to set the GCM API key\n * by either calling setGMAPIKey() or passing in the API key as an option\n * to sendNotification().\n * @param  {string} apiKey The API key to send with the GCM request.\n */\nWebPushLib.prototype.setGCMAPIKey = function(apiKey) {\n  if (apiKey === null) {\n    gcmAPIKey = null;\n    return;\n  }\n\n  if (typeof apiKey === 'undefined'\n  || typeof apiKey !== 'string'\n  || apiKey.length === 0) {\n    throw new Error('The GCM API Key should be a non-empty string or null.');\n  }\n\n  gcmAPIKey = apiKey;\n};\n\n/**\n * When making requests where you want to define VAPID details, call this\n * method before sendNotification() or pass in the details and options to\n * sendNotification.\n * @param  {string} subject    This must be either a URL or a 'mailto:'\n * address. For example: 'https://my-site.com/contact' or\n * 'mailto: contact@my-site.com'\n * @param  {string} publicKey  The public VAPID key, a URL safe, base64 encoded string\n * @param  {string} privateKey The private VAPID key, a URL safe, base64 encoded string.\n */\nWebPushLib.prototype.setVapidDetails = function(subject, publicKey, privateKey) {\n    if (arguments.length === 1 && arguments[0] === null) {\n      vapidDetails = null;\n      return;\n    }\n\n    vapidHelper.validateSubject(subject);\n    vapidHelper.validatePublicKey(publicKey);\n    vapidHelper.validatePrivateKey(privateKey);\n\n    vapidDetails = {\n      subject: subject,\n      publicKey: publicKey,\n      privateKey: privateKey\n    };\n  };\n\n  /**\n   * To get the details of a request to trigger a push message, without sending\n   * a push notification call this method.\n   *\n   * This method will throw an error if there is an issue with the input.\n   * @param  {PushSubscription} subscription The PushSubscription you wish to\n   * send the notification to.\n   * @param  {string|Buffer} [payload]       The payload you wish to send to the\n   * the user.\n   * @param  {Object} [options]              Options for the GCM API key and\n   * vapid keys can be passed in if they are unique for each notification you\n   * wish to send.\n   * @return {Object}                       This method returns an Object which\n   * contains 'endpoint', 'method', 'headers' and 'payload'.\n   */\nWebPushLib.prototype.generateRequestDetails = function(subscription, payload, options) {\n    if (!subscription || !subscription.endpoint) {\n      throw new Error('You must pass in a subscription with at least '\n      + 'an endpoint.');\n    }\n\n    if (typeof subscription.endpoint !== 'string'\n    || subscription.endpoint.length === 0) {\n      throw new Error('The subscription endpoint must be a string with '\n      + 'a valid URL.');\n    }\n\n    if (payload) {\n      // Validate the subscription keys\n      if (typeof subscription !== 'object' || !subscription.keys\n      || !subscription.keys.p256dh\n      || !subscription.keys.auth) {\n        throw new Error('To send a message with a payload, the '\n        + 'subscription must have \\'auth\\' and \\'p256dh\\' keys.');\n      }\n    }\n\n    let currentGCMAPIKey = gcmAPIKey;\n    let currentVapidDetails = vapidDetails;\n    let timeToLive = DEFAULT_TTL;\n    let extraHeaders = {};\n    let contentEncoding = webPushConstants.supportedContentEncodings.AES_128_GCM;\n    let urgency = webPushConstants.supportedUrgency.NORMAL;\n    let topic;\n    let proxy;\n    let agent;\n    let timeout;\n\n    if (options) {\n      const validOptionKeys = [\n        'headers',\n        'gcmAPIKey',\n        'vapidDetails',\n        'TTL',\n        'contentEncoding',\n        'urgency',\n        'topic',\n        'proxy',\n        'agent',\n        'timeout'\n      ];\n      const optionKeys = Object.keys(options);\n      for (let i = 0; i < optionKeys.length; i += 1) {\n        const optionKey = optionKeys[i];\n        if (!validOptionKeys.includes(optionKey)) {\n          throw new Error('\\'' + optionKey + '\\' is an invalid option. '\n          + 'The valid options are [\\'' + validOptionKeys.join('\\', \\'')\n          + '\\'].');\n        }\n      }\n\n      if (options.headers) {\n        extraHeaders = options.headers;\n        let duplicates = Object.keys(extraHeaders)\n            .filter(function (header) {\n              return typeof options[header] !== 'undefined';\n            });\n\n        if (duplicates.length > 0) {\n          throw new Error('Duplicated headers defined ['\n          + duplicates.join(',') + ']. Please either define the header in the'\n          + 'top level options OR in the \\'headers\\' key.');\n        }\n      }\n\n      if (options.gcmAPIKey) {\n        currentGCMAPIKey = options.gcmAPIKey;\n      }\n\n      // Falsy values are allowed here so one can skip Vapid `else if` below and use FCM\n      if (options.vapidDetails !== undefined) {\n        currentVapidDetails = options.vapidDetails;\n      }\n\n      if (options.TTL !== undefined) {\n        timeToLive = Number(options.TTL);\n        if (timeToLive < 0) {\n          throw new Error('TTL should be a number and should be at least 0');\n        }\n      }\n\n      if (options.contentEncoding) {\n        if ((options.contentEncoding === webPushConstants.supportedContentEncodings.AES_128_GCM\n          || options.contentEncoding === webPushConstants.supportedContentEncodings.AES_GCM)) {\n          contentEncoding = options.contentEncoding;\n        } else {\n          throw new Error('Unsupported content encoding specified.');\n        }\n      }\n\n      if (options.urgency) {\n        if ((options.urgency === webPushConstants.supportedUrgency.VERY_LOW\n          || options.urgency === webPushConstants.supportedUrgency.LOW\n          || options.urgency === webPushConstants.supportedUrgency.NORMAL\n          || options.urgency === webPushConstants.supportedUrgency.HIGH)) {\n          urgency = options.urgency;\n        } else {\n          throw new Error('Unsupported urgency specified.');\n        }\n      }\n\n      if (options.topic) {\n        if (!urlBase64Helper.validate(options.topic)) {\n          throw new Error('Unsupported characters set use the URL or filename-safe Base64 characters set');\n        }\n        if (options.topic.length > 32) {\n          throw new Error('use maximum of 32 characters from the URL or filename-safe Base64 characters set');\n        }\n        topic = options.topic;\n      }\n\n      if (options.proxy) {\n        if (typeof options.proxy === 'string'\n          || typeof options.proxy.host === 'string') {\n          proxy = options.proxy;\n        } else {\n          console.warn('Attempt to use proxy option, but invalid type it should be a string or proxy options object.');\n        }\n      }\n\n      if (options.agent) {\n        if (options.agent instanceof https.Agent) {\n          if (proxy) {\n            console.warn('Agent option will be ignored because proxy option is defined.');\n          }\n\n          agent = options.agent;\n        } else {\n          console.warn('Wrong type for the agent option, it should be an instance of https.Agent.');\n        }\n      }\n\n      if (typeof options.timeout === 'number') {\n        timeout = options.timeout;\n      }\n    }\n\n    if (typeof timeToLive === 'undefined') {\n      timeToLive = DEFAULT_TTL;\n    }\n\n    const requestDetails = {\n      method: 'POST',\n      headers: {\n        TTL: timeToLive\n      }\n    };\n    Object.keys(extraHeaders).forEach(function (header) {\n      requestDetails.headers[header] = extraHeaders[header];\n    });\n    let requestPayload = null;\n\n    if (payload) {\n      const encrypted = encryptionHelper\n        .encrypt(subscription.keys.p256dh, subscription.keys.auth, payload, contentEncoding);\n\n      requestDetails.headers['Content-Length'] = encrypted.cipherText.length;\n      requestDetails.headers['Content-Type'] = 'application/octet-stream';\n\n      if (contentEncoding === webPushConstants.supportedContentEncodings.AES_128_GCM) {\n        requestDetails.headers['Content-Encoding'] = webPushConstants.supportedContentEncodings.AES_128_GCM;\n      } else if (contentEncoding === webPushConstants.supportedContentEncodings.AES_GCM) {\n        requestDetails.headers['Content-Encoding'] = webPushConstants.supportedContentEncodings.AES_GCM;\n        requestDetails.headers.Encryption = 'salt=' + encrypted.salt;\n        requestDetails.headers['Crypto-Key'] = 'dh=' + encrypted.localPublicKey.toString('base64url');\n      }\n\n      requestPayload = encrypted.cipherText;\n    } else {\n      requestDetails.headers['Content-Length'] = 0;\n    }\n\n    const isGCM = subscription.endpoint.startsWith('https://android.googleapis.com/gcm/send');\n    const isFCM = subscription.endpoint.startsWith('https://fcm.googleapis.com/fcm/send');\n    // VAPID isn't supported by GCM hence the if, else if.\n    if (isGCM) {\n      if (!currentGCMAPIKey) {\n        console.warn('Attempt to send push notification to GCM endpoint, '\n        + 'but no GCM key is defined. Please use setGCMApiKey() or add '\n        + '\\'gcmAPIKey\\' as an option.');\n      } else {\n        requestDetails.headers.Authorization = 'key=' + currentGCMAPIKey;\n      }\n    } else if (currentVapidDetails) {\n      const parsedUrl = url.parse(subscription.endpoint);\n      const audience = parsedUrl.protocol + '//'\n      + parsedUrl.host;\n\n      const vapidHeaders = vapidHelper.getVapidHeaders(\n        audience,\n        currentVapidDetails.subject,\n        currentVapidDetails.publicKey,\n        currentVapidDetails.privateKey,\n        contentEncoding\n      );\n\n      requestDetails.headers.Authorization = vapidHeaders.Authorization;\n\n      if (contentEncoding === webPushConstants.supportedContentEncodings.AES_GCM) {\n        if (requestDetails.headers['Crypto-Key']) {\n          requestDetails.headers['Crypto-Key'] += ';'\n          + vapidHeaders['Crypto-Key'];\n        } else {\n          requestDetails.headers['Crypto-Key'] = vapidHeaders['Crypto-Key'];\n        }\n      }\n    } else if (isFCM && currentGCMAPIKey) {\n      requestDetails.headers.Authorization = 'key=' + currentGCMAPIKey;\n    }\n\n    requestDetails.headers.Urgency = urgency;\n\n    if (topic) {\n      requestDetails.headers.Topic = topic;\n    }\n\n    requestDetails.body = requestPayload;\n    requestDetails.endpoint = subscription.endpoint;\n\n    if (proxy) {\n      requestDetails.proxy = proxy;\n    }\n\n    if (agent) {\n      requestDetails.agent = agent;\n    }\n\n    if (timeout) {\n      requestDetails.timeout = timeout;\n    }\n\n    return requestDetails;\n  };\n\n/**\n * To send a push notification call this method with a subscription, optional\n * payload and any options.\n * @param  {PushSubscription} subscription The PushSubscription you wish to\n * send the notification to.\n * @param  {string|Buffer} [payload]       The payload you wish to send to the\n * the user.\n * @param  {Object} [options]              Options for the GCM API key and\n * vapid keys can be passed in if they are unique for each notification you\n * wish to send.\n * @return {Promise}                       This method returns a Promise which\n * resolves if the sending of the notification was successful, otherwise it\n * rejects.\n */\nWebPushLib.prototype.sendNotification = function(subscription, payload, options) {\n    let requestDetails;\n    try {\n      requestDetails = this.generateRequestDetails(subscription, payload, options);\n    } catch (err) {\n      return Promise.reject(err);\n    }\n\n    return new Promise(function(resolve, reject) {\n      const httpsOptions = {};\n      const urlParts = url.parse(requestDetails.endpoint);\n      httpsOptions.hostname = urlParts.hostname;\n      httpsOptions.port = urlParts.port;\n      httpsOptions.path = urlParts.path;\n\n      httpsOptions.headers = requestDetails.headers;\n      httpsOptions.method = requestDetails.method;\n\n      if (requestDetails.timeout) {\n        httpsOptions.timeout = requestDetails.timeout;\n      }\n\n      if (requestDetails.agent) {\n        httpsOptions.agent = requestDetails.agent;\n      }\n\n      if (requestDetails.proxy) {\n        const { HttpsProxyAgent } = __webpack_require__(/*! https-proxy-agent */ \"(action-browser)/../../node_modules/.pnpm/https-proxy-agent@7.0.6/node_modules/https-proxy-agent/dist/index.js\"); // eslint-disable-line global-require\n        httpsOptions.agent = new HttpsProxyAgent(requestDetails.proxy);\n      }\n\n      const pushRequest = https.request(httpsOptions, function(pushResponse) {\n        let responseText = '';\n\n        pushResponse.on('data', function(chunk) {\n          responseText += chunk;\n        });\n\n        pushResponse.on('end', function() {\n          if (pushResponse.statusCode < 200 || pushResponse.statusCode > 299) {\n            reject(new WebPushError(\n              'Received unexpected response code',\n              pushResponse.statusCode,\n              pushResponse.headers,\n              responseText,\n              requestDetails.endpoint\n            ));\n          } else {\n            resolve({\n              statusCode: pushResponse.statusCode,\n              body: responseText,\n              headers: pushResponse.headers\n            });\n          }\n        });\n      });\n\n      if (requestDetails.timeout) {\n        pushRequest.on('timeout', function() {\n          pushRequest.destroy(new Error('Socket timeout'));\n        });\n      }\n\n      pushRequest.on('error', function(e) {\n        reject(e);\n      });\n\n      if (requestDetails.body) {\n        pushRequest.write(requestDetails.body);\n      }\n\n      pushRequest.end();\n    });\n  };\n\nmodule.exports = WebPushLib;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFjdGlvbi1icm93c2VyKS8uLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vd2ViLXB1c2hAMy42Ljcvbm9kZV9tb2R1bGVzL3dlYi1wdXNoL3NyYy93ZWItcHVzaC1saWIuanMiLCJtYXBwaW5ncyI6IkFBQWE7O0FBRWIsWUFBWSxtQkFBTyxDQUFDLGdCQUFLO0FBQ3pCLGNBQWMsbUJBQU8sQ0FBQyxvQkFBTzs7QUFFN0IscUJBQXFCLG1CQUFPLENBQUMsaUlBQXFCO0FBQ2xELG9CQUFvQixtQkFBTyxDQUFDLDZIQUFtQjtBQUMvQyx5QkFBeUIsbUJBQU8sQ0FBQyx1SUFBd0I7QUFDekQseUJBQXlCLG1CQUFPLENBQUMseUlBQXlCO0FBQzFELHdCQUF3QixtQkFBTyxDQUFDLDRJQUF5Qjs7QUFFekQ7QUFDQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWSxRQUFRO0FBQ3BCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZLFFBQVE7QUFDcEI7QUFDQTtBQUNBLFlBQVksUUFBUTtBQUNwQixZQUFZLFFBQVE7QUFDcEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWMsa0JBQWtCO0FBQ2hDO0FBQ0EsY0FBYyxlQUFlO0FBQzdCO0FBQ0EsY0FBYyxRQUFRO0FBQ3RCO0FBQ0E7QUFDQSxjQUFjLDhCQUE4QjtBQUM1QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0JBQXNCLHVCQUF1QjtBQUM3QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTs7QUFFYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxNQUFNO0FBQ047QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQSxvREFBb0Q7QUFDcEQ7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxZQUFZLGtCQUFrQjtBQUM5QjtBQUNBLFlBQVksZUFBZTtBQUMzQjtBQUNBLFlBQVksUUFBUTtBQUNwQjtBQUNBO0FBQ0EsWUFBWSwrQkFBK0I7QUFDM0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0EsZ0JBQWdCLGtCQUFrQixFQUFFLG1CQUFPLENBQUMseUlBQW1CLEdBQUc7QUFDbEU7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxTQUFTOztBQUVUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVk7QUFDWjtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBLFNBQVM7QUFDVCxPQUFPOztBQUVQO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDs7QUFFQTtBQUNBO0FBQ0EsT0FBTzs7QUFFUDtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxLQUFLO0FBQ0w7O0FBRUEiLCJzb3VyY2VzIjpbIkM6XFxEZXZcXEN1cnNvcldlYkFwcFRlbXBsYXRlXFxub2RlX21vZHVsZXNcXC5wbnBtXFx3ZWItcHVzaEAzLjYuN1xcbm9kZV9tb2R1bGVzXFx3ZWItcHVzaFxcc3JjXFx3ZWItcHVzaC1saWIuanMiXSwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xuXG5jb25zdCB1cmwgPSByZXF1aXJlKCd1cmwnKTtcbmNvbnN0IGh0dHBzID0gcmVxdWlyZSgnaHR0cHMnKTtcblxuY29uc3QgV2ViUHVzaEVycm9yID0gcmVxdWlyZSgnLi93ZWItcHVzaC1lcnJvci5qcycpO1xuY29uc3QgdmFwaWRIZWxwZXIgPSByZXF1aXJlKCcuL3ZhcGlkLWhlbHBlci5qcycpO1xuY29uc3QgZW5jcnlwdGlvbkhlbHBlciA9IHJlcXVpcmUoJy4vZW5jcnlwdGlvbi1oZWxwZXIuanMnKTtcbmNvbnN0IHdlYlB1c2hDb25zdGFudHMgPSByZXF1aXJlKCcuL3dlYi1wdXNoLWNvbnN0YW50cy5qcycpO1xuY29uc3QgdXJsQmFzZTY0SGVscGVyID0gcmVxdWlyZSgnLi91cmxzYWZlLWJhc2U2NC1oZWxwZXInKTtcblxuLy8gRGVmYXVsdCBUVEwgaXMgZm91ciB3ZWVrcy5cbmNvbnN0IERFRkFVTFRfVFRMID0gMjQxOTIwMDtcblxubGV0IGdjbUFQSUtleSA9ICcnO1xubGV0IHZhcGlkRGV0YWlscztcblxuZnVuY3Rpb24gV2ViUHVzaExpYigpIHtcblxufVxuXG4vKipcbiAqIFdoZW4gc2VuZGluZyBtZXNzYWdlcyB0byBhIEdDTSBlbmRwb2ludCB5b3UgbmVlZCB0byBzZXQgdGhlIEdDTSBBUEkga2V5XG4gKiBieSBlaXRoZXIgY2FsbGluZyBzZXRHTUFQSUtleSgpIG9yIHBhc3NpbmcgaW4gdGhlIEFQSSBrZXkgYXMgYW4gb3B0aW9uXG4gKiB0byBzZW5kTm90aWZpY2F0aW9uKCkuXG4gKiBAcGFyYW0gIHtzdHJpbmd9IGFwaUtleSBUaGUgQVBJIGtleSB0byBzZW5kIHdpdGggdGhlIEdDTSByZXF1ZXN0LlxuICovXG5XZWJQdXNoTGliLnByb3RvdHlwZS5zZXRHQ01BUElLZXkgPSBmdW5jdGlvbihhcGlLZXkpIHtcbiAgaWYgKGFwaUtleSA9PT0gbnVsbCkge1xuICAgIGdjbUFQSUtleSA9IG51bGw7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgaWYgKHR5cGVvZiBhcGlLZXkgPT09ICd1bmRlZmluZWQnXG4gIHx8IHR5cGVvZiBhcGlLZXkgIT09ICdzdHJpbmcnXG4gIHx8IGFwaUtleS5sZW5ndGggPT09IDApIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ1RoZSBHQ00gQVBJIEtleSBzaG91bGQgYmUgYSBub24tZW1wdHkgc3RyaW5nIG9yIG51bGwuJyk7XG4gIH1cblxuICBnY21BUElLZXkgPSBhcGlLZXk7XG59O1xuXG4vKipcbiAqIFdoZW4gbWFraW5nIHJlcXVlc3RzIHdoZXJlIHlvdSB3YW50IHRvIGRlZmluZSBWQVBJRCBkZXRhaWxzLCBjYWxsIHRoaXNcbiAqIG1ldGhvZCBiZWZvcmUgc2VuZE5vdGlmaWNhdGlvbigpIG9yIHBhc3MgaW4gdGhlIGRldGFpbHMgYW5kIG9wdGlvbnMgdG9cbiAqIHNlbmROb3RpZmljYXRpb24uXG4gKiBAcGFyYW0gIHtzdHJpbmd9IHN1YmplY3QgICAgVGhpcyBtdXN0IGJlIGVpdGhlciBhIFVSTCBvciBhICdtYWlsdG86J1xuICogYWRkcmVzcy4gRm9yIGV4YW1wbGU6ICdodHRwczovL215LXNpdGUuY29tL2NvbnRhY3QnIG9yXG4gKiAnbWFpbHRvOiBjb250YWN0QG15LXNpdGUuY29tJ1xuICogQHBhcmFtICB7c3RyaW5nfSBwdWJsaWNLZXkgIFRoZSBwdWJsaWMgVkFQSUQga2V5LCBhIFVSTCBzYWZlLCBiYXNlNjQgZW5jb2RlZCBzdHJpbmdcbiAqIEBwYXJhbSAge3N0cmluZ30gcHJpdmF0ZUtleSBUaGUgcHJpdmF0ZSBWQVBJRCBrZXksIGEgVVJMIHNhZmUsIGJhc2U2NCBlbmNvZGVkIHN0cmluZy5cbiAqL1xuV2ViUHVzaExpYi5wcm90b3R5cGUuc2V0VmFwaWREZXRhaWxzID0gZnVuY3Rpb24oc3ViamVjdCwgcHVibGljS2V5LCBwcml2YXRlS2V5KSB7XG4gICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPT09IDEgJiYgYXJndW1lbnRzWzBdID09PSBudWxsKSB7XG4gICAgICB2YXBpZERldGFpbHMgPSBudWxsO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHZhcGlkSGVscGVyLnZhbGlkYXRlU3ViamVjdChzdWJqZWN0KTtcbiAgICB2YXBpZEhlbHBlci52YWxpZGF0ZVB1YmxpY0tleShwdWJsaWNLZXkpO1xuICAgIHZhcGlkSGVscGVyLnZhbGlkYXRlUHJpdmF0ZUtleShwcml2YXRlS2V5KTtcblxuICAgIHZhcGlkRGV0YWlscyA9IHtcbiAgICAgIHN1YmplY3Q6IHN1YmplY3QsXG4gICAgICBwdWJsaWNLZXk6IHB1YmxpY0tleSxcbiAgICAgIHByaXZhdGVLZXk6IHByaXZhdGVLZXlcbiAgICB9O1xuICB9O1xuXG4gIC8qKlxuICAgKiBUbyBnZXQgdGhlIGRldGFpbHMgb2YgYSByZXF1ZXN0IHRvIHRyaWdnZXIgYSBwdXNoIG1lc3NhZ2UsIHdpdGhvdXQgc2VuZGluZ1xuICAgKiBhIHB1c2ggbm90aWZpY2F0aW9uIGNhbGwgdGhpcyBtZXRob2QuXG4gICAqXG4gICAqIFRoaXMgbWV0aG9kIHdpbGwgdGhyb3cgYW4gZXJyb3IgaWYgdGhlcmUgaXMgYW4gaXNzdWUgd2l0aCB0aGUgaW5wdXQuXG4gICAqIEBwYXJhbSAge1B1c2hTdWJzY3JpcHRpb259IHN1YnNjcmlwdGlvbiBUaGUgUHVzaFN1YnNjcmlwdGlvbiB5b3Ugd2lzaCB0b1xuICAgKiBzZW5kIHRoZSBub3RpZmljYXRpb24gdG8uXG4gICAqIEBwYXJhbSAge3N0cmluZ3xCdWZmZXJ9IFtwYXlsb2FkXSAgICAgICBUaGUgcGF5bG9hZCB5b3Ugd2lzaCB0byBzZW5kIHRvIHRoZVxuICAgKiB0aGUgdXNlci5cbiAgICogQHBhcmFtICB7T2JqZWN0fSBbb3B0aW9uc10gICAgICAgICAgICAgIE9wdGlvbnMgZm9yIHRoZSBHQ00gQVBJIGtleSBhbmRcbiAgICogdmFwaWQga2V5cyBjYW4gYmUgcGFzc2VkIGluIGlmIHRoZXkgYXJlIHVuaXF1ZSBmb3IgZWFjaCBub3RpZmljYXRpb24geW91XG4gICAqIHdpc2ggdG8gc2VuZC5cbiAgICogQHJldHVybiB7T2JqZWN0fSAgICAgICAgICAgICAgICAgICAgICAgVGhpcyBtZXRob2QgcmV0dXJucyBhbiBPYmplY3Qgd2hpY2hcbiAgICogY29udGFpbnMgJ2VuZHBvaW50JywgJ21ldGhvZCcsICdoZWFkZXJzJyBhbmQgJ3BheWxvYWQnLlxuICAgKi9cbldlYlB1c2hMaWIucHJvdG90eXBlLmdlbmVyYXRlUmVxdWVzdERldGFpbHMgPSBmdW5jdGlvbihzdWJzY3JpcHRpb24sIHBheWxvYWQsIG9wdGlvbnMpIHtcbiAgICBpZiAoIXN1YnNjcmlwdGlvbiB8fCAhc3Vic2NyaXB0aW9uLmVuZHBvaW50KSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1lvdSBtdXN0IHBhc3MgaW4gYSBzdWJzY3JpcHRpb24gd2l0aCBhdCBsZWFzdCAnXG4gICAgICArICdhbiBlbmRwb2ludC4nKTtcbiAgICB9XG5cbiAgICBpZiAodHlwZW9mIHN1YnNjcmlwdGlvbi5lbmRwb2ludCAhPT0gJ3N0cmluZydcbiAgICB8fCBzdWJzY3JpcHRpb24uZW5kcG9pbnQubGVuZ3RoID09PSAwKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1RoZSBzdWJzY3JpcHRpb24gZW5kcG9pbnQgbXVzdCBiZSBhIHN0cmluZyB3aXRoICdcbiAgICAgICsgJ2EgdmFsaWQgVVJMLicpO1xuICAgIH1cblxuICAgIGlmIChwYXlsb2FkKSB7XG4gICAgICAvLyBWYWxpZGF0ZSB0aGUgc3Vic2NyaXB0aW9uIGtleXNcbiAgICAgIGlmICh0eXBlb2Ygc3Vic2NyaXB0aW9uICE9PSAnb2JqZWN0JyB8fCAhc3Vic2NyaXB0aW9uLmtleXNcbiAgICAgIHx8ICFzdWJzY3JpcHRpb24ua2V5cy5wMjU2ZGhcbiAgICAgIHx8ICFzdWJzY3JpcHRpb24ua2V5cy5hdXRoKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignVG8gc2VuZCBhIG1lc3NhZ2Ugd2l0aCBhIHBheWxvYWQsIHRoZSAnXG4gICAgICAgICsgJ3N1YnNjcmlwdGlvbiBtdXN0IGhhdmUgXFwnYXV0aFxcJyBhbmQgXFwncDI1NmRoXFwnIGtleXMuJyk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgbGV0IGN1cnJlbnRHQ01BUElLZXkgPSBnY21BUElLZXk7XG4gICAgbGV0IGN1cnJlbnRWYXBpZERldGFpbHMgPSB2YXBpZERldGFpbHM7XG4gICAgbGV0IHRpbWVUb0xpdmUgPSBERUZBVUxUX1RUTDtcbiAgICBsZXQgZXh0cmFIZWFkZXJzID0ge307XG4gICAgbGV0IGNvbnRlbnRFbmNvZGluZyA9IHdlYlB1c2hDb25zdGFudHMuc3VwcG9ydGVkQ29udGVudEVuY29kaW5ncy5BRVNfMTI4X0dDTTtcbiAgICBsZXQgdXJnZW5jeSA9IHdlYlB1c2hDb25zdGFudHMuc3VwcG9ydGVkVXJnZW5jeS5OT1JNQUw7XG4gICAgbGV0IHRvcGljO1xuICAgIGxldCBwcm94eTtcbiAgICBsZXQgYWdlbnQ7XG4gICAgbGV0IHRpbWVvdXQ7XG5cbiAgICBpZiAob3B0aW9ucykge1xuICAgICAgY29uc3QgdmFsaWRPcHRpb25LZXlzID0gW1xuICAgICAgICAnaGVhZGVycycsXG4gICAgICAgICdnY21BUElLZXknLFxuICAgICAgICAndmFwaWREZXRhaWxzJyxcbiAgICAgICAgJ1RUTCcsXG4gICAgICAgICdjb250ZW50RW5jb2RpbmcnLFxuICAgICAgICAndXJnZW5jeScsXG4gICAgICAgICd0b3BpYycsXG4gICAgICAgICdwcm94eScsXG4gICAgICAgICdhZ2VudCcsXG4gICAgICAgICd0aW1lb3V0J1xuICAgICAgXTtcbiAgICAgIGNvbnN0IG9wdGlvbktleXMgPSBPYmplY3Qua2V5cyhvcHRpb25zKTtcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgb3B0aW9uS2V5cy5sZW5ndGg7IGkgKz0gMSkge1xuICAgICAgICBjb25zdCBvcHRpb25LZXkgPSBvcHRpb25LZXlzW2ldO1xuICAgICAgICBpZiAoIXZhbGlkT3B0aW9uS2V5cy5pbmNsdWRlcyhvcHRpb25LZXkpKSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdcXCcnICsgb3B0aW9uS2V5ICsgJ1xcJyBpcyBhbiBpbnZhbGlkIG9wdGlvbi4gJ1xuICAgICAgICAgICsgJ1RoZSB2YWxpZCBvcHRpb25zIGFyZSBbXFwnJyArIHZhbGlkT3B0aW9uS2V5cy5qb2luKCdcXCcsIFxcJycpXG4gICAgICAgICAgKyAnXFwnXS4nKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBpZiAob3B0aW9ucy5oZWFkZXJzKSB7XG4gICAgICAgIGV4dHJhSGVhZGVycyA9IG9wdGlvbnMuaGVhZGVycztcbiAgICAgICAgbGV0IGR1cGxpY2F0ZXMgPSBPYmplY3Qua2V5cyhleHRyYUhlYWRlcnMpXG4gICAgICAgICAgICAuZmlsdGVyKGZ1bmN0aW9uIChoZWFkZXIpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIHR5cGVvZiBvcHRpb25zW2hlYWRlcl0gIT09ICd1bmRlZmluZWQnO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgaWYgKGR1cGxpY2F0ZXMubGVuZ3RoID4gMCkge1xuICAgICAgICAgIHRocm93IG5ldyBFcnJvcignRHVwbGljYXRlZCBoZWFkZXJzIGRlZmluZWQgWydcbiAgICAgICAgICArIGR1cGxpY2F0ZXMuam9pbignLCcpICsgJ10uIFBsZWFzZSBlaXRoZXIgZGVmaW5lIHRoZSBoZWFkZXIgaW4gdGhlJ1xuICAgICAgICAgICsgJ3RvcCBsZXZlbCBvcHRpb25zIE9SIGluIHRoZSBcXCdoZWFkZXJzXFwnIGtleS4nKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBpZiAob3B0aW9ucy5nY21BUElLZXkpIHtcbiAgICAgICAgY3VycmVudEdDTUFQSUtleSA9IG9wdGlvbnMuZ2NtQVBJS2V5O1xuICAgICAgfVxuXG4gICAgICAvLyBGYWxzeSB2YWx1ZXMgYXJlIGFsbG93ZWQgaGVyZSBzbyBvbmUgY2FuIHNraXAgVmFwaWQgYGVsc2UgaWZgIGJlbG93IGFuZCB1c2UgRkNNXG4gICAgICBpZiAob3B0aW9ucy52YXBpZERldGFpbHMgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICBjdXJyZW50VmFwaWREZXRhaWxzID0gb3B0aW9ucy52YXBpZERldGFpbHM7XG4gICAgICB9XG5cbiAgICAgIGlmIChvcHRpb25zLlRUTCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHRpbWVUb0xpdmUgPSBOdW1iZXIob3B0aW9ucy5UVEwpO1xuICAgICAgICBpZiAodGltZVRvTGl2ZSA8IDApIHtcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1RUTCBzaG91bGQgYmUgYSBudW1iZXIgYW5kIHNob3VsZCBiZSBhdCBsZWFzdCAwJyk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgaWYgKG9wdGlvbnMuY29udGVudEVuY29kaW5nKSB7XG4gICAgICAgIGlmICgob3B0aW9ucy5jb250ZW50RW5jb2RpbmcgPT09IHdlYlB1c2hDb25zdGFudHMuc3VwcG9ydGVkQ29udGVudEVuY29kaW5ncy5BRVNfMTI4X0dDTVxuICAgICAgICAgIHx8IG9wdGlvbnMuY29udGVudEVuY29kaW5nID09PSB3ZWJQdXNoQ29uc3RhbnRzLnN1cHBvcnRlZENvbnRlbnRFbmNvZGluZ3MuQUVTX0dDTSkpIHtcbiAgICAgICAgICBjb250ZW50RW5jb2RpbmcgPSBvcHRpb25zLmNvbnRlbnRFbmNvZGluZztcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1Vuc3VwcG9ydGVkIGNvbnRlbnQgZW5jb2Rpbmcgc3BlY2lmaWVkLicpO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGlmIChvcHRpb25zLnVyZ2VuY3kpIHtcbiAgICAgICAgaWYgKChvcHRpb25zLnVyZ2VuY3kgPT09IHdlYlB1c2hDb25zdGFudHMuc3VwcG9ydGVkVXJnZW5jeS5WRVJZX0xPV1xuICAgICAgICAgIHx8IG9wdGlvbnMudXJnZW5jeSA9PT0gd2ViUHVzaENvbnN0YW50cy5zdXBwb3J0ZWRVcmdlbmN5LkxPV1xuICAgICAgICAgIHx8IG9wdGlvbnMudXJnZW5jeSA9PT0gd2ViUHVzaENvbnN0YW50cy5zdXBwb3J0ZWRVcmdlbmN5Lk5PUk1BTFxuICAgICAgICAgIHx8IG9wdGlvbnMudXJnZW5jeSA9PT0gd2ViUHVzaENvbnN0YW50cy5zdXBwb3J0ZWRVcmdlbmN5LkhJR0gpKSB7XG4gICAgICAgICAgdXJnZW5jeSA9IG9wdGlvbnMudXJnZW5jeTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1Vuc3VwcG9ydGVkIHVyZ2VuY3kgc3BlY2lmaWVkLicpO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGlmIChvcHRpb25zLnRvcGljKSB7XG4gICAgICAgIGlmICghdXJsQmFzZTY0SGVscGVyLnZhbGlkYXRlKG9wdGlvbnMudG9waWMpKSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdVbnN1cHBvcnRlZCBjaGFyYWN0ZXJzIHNldCB1c2UgdGhlIFVSTCBvciBmaWxlbmFtZS1zYWZlIEJhc2U2NCBjaGFyYWN0ZXJzIHNldCcpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChvcHRpb25zLnRvcGljLmxlbmd0aCA+IDMyKSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCd1c2UgbWF4aW11bSBvZiAzMiBjaGFyYWN0ZXJzIGZyb20gdGhlIFVSTCBvciBmaWxlbmFtZS1zYWZlIEJhc2U2NCBjaGFyYWN0ZXJzIHNldCcpO1xuICAgICAgICB9XG4gICAgICAgIHRvcGljID0gb3B0aW9ucy50b3BpYztcbiAgICAgIH1cblxuICAgICAgaWYgKG9wdGlvbnMucHJveHkpIHtcbiAgICAgICAgaWYgKHR5cGVvZiBvcHRpb25zLnByb3h5ID09PSAnc3RyaW5nJ1xuICAgICAgICAgIHx8IHR5cGVvZiBvcHRpb25zLnByb3h5Lmhvc3QgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgcHJveHkgPSBvcHRpb25zLnByb3h5O1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGNvbnNvbGUud2FybignQXR0ZW1wdCB0byB1c2UgcHJveHkgb3B0aW9uLCBidXQgaW52YWxpZCB0eXBlIGl0IHNob3VsZCBiZSBhIHN0cmluZyBvciBwcm94eSBvcHRpb25zIG9iamVjdC4nKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBpZiAob3B0aW9ucy5hZ2VudCkge1xuICAgICAgICBpZiAob3B0aW9ucy5hZ2VudCBpbnN0YW5jZW9mIGh0dHBzLkFnZW50KSB7XG4gICAgICAgICAgaWYgKHByb3h5KSB7XG4gICAgICAgICAgICBjb25zb2xlLndhcm4oJ0FnZW50IG9wdGlvbiB3aWxsIGJlIGlnbm9yZWQgYmVjYXVzZSBwcm94eSBvcHRpb24gaXMgZGVmaW5lZC4nKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBhZ2VudCA9IG9wdGlvbnMuYWdlbnQ7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgY29uc29sZS53YXJuKCdXcm9uZyB0eXBlIGZvciB0aGUgYWdlbnQgb3B0aW9uLCBpdCBzaG91bGQgYmUgYW4gaW5zdGFuY2Ugb2YgaHR0cHMuQWdlbnQuJyk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgaWYgKHR5cGVvZiBvcHRpb25zLnRpbWVvdXQgPT09ICdudW1iZXInKSB7XG4gICAgICAgIHRpbWVvdXQgPSBvcHRpb25zLnRpbWVvdXQ7XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKHR5cGVvZiB0aW1lVG9MaXZlID09PSAndW5kZWZpbmVkJykge1xuICAgICAgdGltZVRvTGl2ZSA9IERFRkFVTFRfVFRMO1xuICAgIH1cblxuICAgIGNvbnN0IHJlcXVlc3REZXRhaWxzID0ge1xuICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICBoZWFkZXJzOiB7XG4gICAgICAgIFRUTDogdGltZVRvTGl2ZVxuICAgICAgfVxuICAgIH07XG4gICAgT2JqZWN0LmtleXMoZXh0cmFIZWFkZXJzKS5mb3JFYWNoKGZ1bmN0aW9uIChoZWFkZXIpIHtcbiAgICAgIHJlcXVlc3REZXRhaWxzLmhlYWRlcnNbaGVhZGVyXSA9IGV4dHJhSGVhZGVyc1toZWFkZXJdO1xuICAgIH0pO1xuICAgIGxldCByZXF1ZXN0UGF5bG9hZCA9IG51bGw7XG5cbiAgICBpZiAocGF5bG9hZCkge1xuICAgICAgY29uc3QgZW5jcnlwdGVkID0gZW5jcnlwdGlvbkhlbHBlclxuICAgICAgICAuZW5jcnlwdChzdWJzY3JpcHRpb24ua2V5cy5wMjU2ZGgsIHN1YnNjcmlwdGlvbi5rZXlzLmF1dGgsIHBheWxvYWQsIGNvbnRlbnRFbmNvZGluZyk7XG5cbiAgICAgIHJlcXVlc3REZXRhaWxzLmhlYWRlcnNbJ0NvbnRlbnQtTGVuZ3RoJ10gPSBlbmNyeXB0ZWQuY2lwaGVyVGV4dC5sZW5ndGg7XG4gICAgICByZXF1ZXN0RGV0YWlscy5oZWFkZXJzWydDb250ZW50LVR5cGUnXSA9ICdhcHBsaWNhdGlvbi9vY3RldC1zdHJlYW0nO1xuXG4gICAgICBpZiAoY29udGVudEVuY29kaW5nID09PSB3ZWJQdXNoQ29uc3RhbnRzLnN1cHBvcnRlZENvbnRlbnRFbmNvZGluZ3MuQUVTXzEyOF9HQ00pIHtcbiAgICAgICAgcmVxdWVzdERldGFpbHMuaGVhZGVyc1snQ29udGVudC1FbmNvZGluZyddID0gd2ViUHVzaENvbnN0YW50cy5zdXBwb3J0ZWRDb250ZW50RW5jb2RpbmdzLkFFU18xMjhfR0NNO1xuICAgICAgfSBlbHNlIGlmIChjb250ZW50RW5jb2RpbmcgPT09IHdlYlB1c2hDb25zdGFudHMuc3VwcG9ydGVkQ29udGVudEVuY29kaW5ncy5BRVNfR0NNKSB7XG4gICAgICAgIHJlcXVlc3REZXRhaWxzLmhlYWRlcnNbJ0NvbnRlbnQtRW5jb2RpbmcnXSA9IHdlYlB1c2hDb25zdGFudHMuc3VwcG9ydGVkQ29udGVudEVuY29kaW5ncy5BRVNfR0NNO1xuICAgICAgICByZXF1ZXN0RGV0YWlscy5oZWFkZXJzLkVuY3J5cHRpb24gPSAnc2FsdD0nICsgZW5jcnlwdGVkLnNhbHQ7XG4gICAgICAgIHJlcXVlc3REZXRhaWxzLmhlYWRlcnNbJ0NyeXB0by1LZXknXSA9ICdkaD0nICsgZW5jcnlwdGVkLmxvY2FsUHVibGljS2V5LnRvU3RyaW5nKCdiYXNlNjR1cmwnKTtcbiAgICAgIH1cblxuICAgICAgcmVxdWVzdFBheWxvYWQgPSBlbmNyeXB0ZWQuY2lwaGVyVGV4dDtcbiAgICB9IGVsc2Uge1xuICAgICAgcmVxdWVzdERldGFpbHMuaGVhZGVyc1snQ29udGVudC1MZW5ndGgnXSA9IDA7XG4gICAgfVxuXG4gICAgY29uc3QgaXNHQ00gPSBzdWJzY3JpcHRpb24uZW5kcG9pbnQuc3RhcnRzV2l0aCgnaHR0cHM6Ly9hbmRyb2lkLmdvb2dsZWFwaXMuY29tL2djbS9zZW5kJyk7XG4gICAgY29uc3QgaXNGQ00gPSBzdWJzY3JpcHRpb24uZW5kcG9pbnQuc3RhcnRzV2l0aCgnaHR0cHM6Ly9mY20uZ29vZ2xlYXBpcy5jb20vZmNtL3NlbmQnKTtcbiAgICAvLyBWQVBJRCBpc24ndCBzdXBwb3J0ZWQgYnkgR0NNIGhlbmNlIHRoZSBpZiwgZWxzZSBpZi5cbiAgICBpZiAoaXNHQ00pIHtcbiAgICAgIGlmICghY3VycmVudEdDTUFQSUtleSkge1xuICAgICAgICBjb25zb2xlLndhcm4oJ0F0dGVtcHQgdG8gc2VuZCBwdXNoIG5vdGlmaWNhdGlvbiB0byBHQ00gZW5kcG9pbnQsICdcbiAgICAgICAgKyAnYnV0IG5vIEdDTSBrZXkgaXMgZGVmaW5lZC4gUGxlYXNlIHVzZSBzZXRHQ01BcGlLZXkoKSBvciBhZGQgJ1xuICAgICAgICArICdcXCdnY21BUElLZXlcXCcgYXMgYW4gb3B0aW9uLicpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmVxdWVzdERldGFpbHMuaGVhZGVycy5BdXRob3JpemF0aW9uID0gJ2tleT0nICsgY3VycmVudEdDTUFQSUtleTtcbiAgICAgIH1cbiAgICB9IGVsc2UgaWYgKGN1cnJlbnRWYXBpZERldGFpbHMpIHtcbiAgICAgIGNvbnN0IHBhcnNlZFVybCA9IHVybC5wYXJzZShzdWJzY3JpcHRpb24uZW5kcG9pbnQpO1xuICAgICAgY29uc3QgYXVkaWVuY2UgPSBwYXJzZWRVcmwucHJvdG9jb2wgKyAnLy8nXG4gICAgICArIHBhcnNlZFVybC5ob3N0O1xuXG4gICAgICBjb25zdCB2YXBpZEhlYWRlcnMgPSB2YXBpZEhlbHBlci5nZXRWYXBpZEhlYWRlcnMoXG4gICAgICAgIGF1ZGllbmNlLFxuICAgICAgICBjdXJyZW50VmFwaWREZXRhaWxzLnN1YmplY3QsXG4gICAgICAgIGN1cnJlbnRWYXBpZERldGFpbHMucHVibGljS2V5LFxuICAgICAgICBjdXJyZW50VmFwaWREZXRhaWxzLnByaXZhdGVLZXksXG4gICAgICAgIGNvbnRlbnRFbmNvZGluZ1xuICAgICAgKTtcblxuICAgICAgcmVxdWVzdERldGFpbHMuaGVhZGVycy5BdXRob3JpemF0aW9uID0gdmFwaWRIZWFkZXJzLkF1dGhvcml6YXRpb247XG5cbiAgICAgIGlmIChjb250ZW50RW5jb2RpbmcgPT09IHdlYlB1c2hDb25zdGFudHMuc3VwcG9ydGVkQ29udGVudEVuY29kaW5ncy5BRVNfR0NNKSB7XG4gICAgICAgIGlmIChyZXF1ZXN0RGV0YWlscy5oZWFkZXJzWydDcnlwdG8tS2V5J10pIHtcbiAgICAgICAgICByZXF1ZXN0RGV0YWlscy5oZWFkZXJzWydDcnlwdG8tS2V5J10gKz0gJzsnXG4gICAgICAgICAgKyB2YXBpZEhlYWRlcnNbJ0NyeXB0by1LZXknXTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICByZXF1ZXN0RGV0YWlscy5oZWFkZXJzWydDcnlwdG8tS2V5J10gPSB2YXBpZEhlYWRlcnNbJ0NyeXB0by1LZXknXTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0gZWxzZSBpZiAoaXNGQ00gJiYgY3VycmVudEdDTUFQSUtleSkge1xuICAgICAgcmVxdWVzdERldGFpbHMuaGVhZGVycy5BdXRob3JpemF0aW9uID0gJ2tleT0nICsgY3VycmVudEdDTUFQSUtleTtcbiAgICB9XG5cbiAgICByZXF1ZXN0RGV0YWlscy5oZWFkZXJzLlVyZ2VuY3kgPSB1cmdlbmN5O1xuXG4gICAgaWYgKHRvcGljKSB7XG4gICAgICByZXF1ZXN0RGV0YWlscy5oZWFkZXJzLlRvcGljID0gdG9waWM7XG4gICAgfVxuXG4gICAgcmVxdWVzdERldGFpbHMuYm9keSA9IHJlcXVlc3RQYXlsb2FkO1xuICAgIHJlcXVlc3REZXRhaWxzLmVuZHBvaW50ID0gc3Vic2NyaXB0aW9uLmVuZHBvaW50O1xuXG4gICAgaWYgKHByb3h5KSB7XG4gICAgICByZXF1ZXN0RGV0YWlscy5wcm94eSA9IHByb3h5O1xuICAgIH1cblxuICAgIGlmIChhZ2VudCkge1xuICAgICAgcmVxdWVzdERldGFpbHMuYWdlbnQgPSBhZ2VudDtcbiAgICB9XG5cbiAgICBpZiAodGltZW91dCkge1xuICAgICAgcmVxdWVzdERldGFpbHMudGltZW91dCA9IHRpbWVvdXQ7XG4gICAgfVxuXG4gICAgcmV0dXJuIHJlcXVlc3REZXRhaWxzO1xuICB9O1xuXG4vKipcbiAqIFRvIHNlbmQgYSBwdXNoIG5vdGlmaWNhdGlvbiBjYWxsIHRoaXMgbWV0aG9kIHdpdGggYSBzdWJzY3JpcHRpb24sIG9wdGlvbmFsXG4gKiBwYXlsb2FkIGFuZCBhbnkgb3B0aW9ucy5cbiAqIEBwYXJhbSAge1B1c2hTdWJzY3JpcHRpb259IHN1YnNjcmlwdGlvbiBUaGUgUHVzaFN1YnNjcmlwdGlvbiB5b3Ugd2lzaCB0b1xuICogc2VuZCB0aGUgbm90aWZpY2F0aW9uIHRvLlxuICogQHBhcmFtICB7c3RyaW5nfEJ1ZmZlcn0gW3BheWxvYWRdICAgICAgIFRoZSBwYXlsb2FkIHlvdSB3aXNoIHRvIHNlbmQgdG8gdGhlXG4gKiB0aGUgdXNlci5cbiAqIEBwYXJhbSAge09iamVjdH0gW29wdGlvbnNdICAgICAgICAgICAgICBPcHRpb25zIGZvciB0aGUgR0NNIEFQSSBrZXkgYW5kXG4gKiB2YXBpZCBrZXlzIGNhbiBiZSBwYXNzZWQgaW4gaWYgdGhleSBhcmUgdW5pcXVlIGZvciBlYWNoIG5vdGlmaWNhdGlvbiB5b3VcbiAqIHdpc2ggdG8gc2VuZC5cbiAqIEByZXR1cm4ge1Byb21pc2V9ICAgICAgICAgICAgICAgICAgICAgICBUaGlzIG1ldGhvZCByZXR1cm5zIGEgUHJvbWlzZSB3aGljaFxuICogcmVzb2x2ZXMgaWYgdGhlIHNlbmRpbmcgb2YgdGhlIG5vdGlmaWNhdGlvbiB3YXMgc3VjY2Vzc2Z1bCwgb3RoZXJ3aXNlIGl0XG4gKiByZWplY3RzLlxuICovXG5XZWJQdXNoTGliLnByb3RvdHlwZS5zZW5kTm90aWZpY2F0aW9uID0gZnVuY3Rpb24oc3Vic2NyaXB0aW9uLCBwYXlsb2FkLCBvcHRpb25zKSB7XG4gICAgbGV0IHJlcXVlc3REZXRhaWxzO1xuICAgIHRyeSB7XG4gICAgICByZXF1ZXN0RGV0YWlscyA9IHRoaXMuZ2VuZXJhdGVSZXF1ZXN0RGV0YWlscyhzdWJzY3JpcHRpb24sIHBheWxvYWQsIG9wdGlvbnMpO1xuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGVycik7XG4gICAgfVxuXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgY29uc3QgaHR0cHNPcHRpb25zID0ge307XG4gICAgICBjb25zdCB1cmxQYXJ0cyA9IHVybC5wYXJzZShyZXF1ZXN0RGV0YWlscy5lbmRwb2ludCk7XG4gICAgICBodHRwc09wdGlvbnMuaG9zdG5hbWUgPSB1cmxQYXJ0cy5ob3N0bmFtZTtcbiAgICAgIGh0dHBzT3B0aW9ucy5wb3J0ID0gdXJsUGFydHMucG9ydDtcbiAgICAgIGh0dHBzT3B0aW9ucy5wYXRoID0gdXJsUGFydHMucGF0aDtcblxuICAgICAgaHR0cHNPcHRpb25zLmhlYWRlcnMgPSByZXF1ZXN0RGV0YWlscy5oZWFkZXJzO1xuICAgICAgaHR0cHNPcHRpb25zLm1ldGhvZCA9IHJlcXVlc3REZXRhaWxzLm1ldGhvZDtcblxuICAgICAgaWYgKHJlcXVlc3REZXRhaWxzLnRpbWVvdXQpIHtcbiAgICAgICAgaHR0cHNPcHRpb25zLnRpbWVvdXQgPSByZXF1ZXN0RGV0YWlscy50aW1lb3V0O1xuICAgICAgfVxuXG4gICAgICBpZiAocmVxdWVzdERldGFpbHMuYWdlbnQpIHtcbiAgICAgICAgaHR0cHNPcHRpb25zLmFnZW50ID0gcmVxdWVzdERldGFpbHMuYWdlbnQ7XG4gICAgICB9XG5cbiAgICAgIGlmIChyZXF1ZXN0RGV0YWlscy5wcm94eSkge1xuICAgICAgICBjb25zdCB7IEh0dHBzUHJveHlBZ2VudCB9ID0gcmVxdWlyZSgnaHR0cHMtcHJveHktYWdlbnQnKTsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBnbG9iYWwtcmVxdWlyZVxuICAgICAgICBodHRwc09wdGlvbnMuYWdlbnQgPSBuZXcgSHR0cHNQcm94eUFnZW50KHJlcXVlc3REZXRhaWxzLnByb3h5KTtcbiAgICAgIH1cblxuICAgICAgY29uc3QgcHVzaFJlcXVlc3QgPSBodHRwcy5yZXF1ZXN0KGh0dHBzT3B0aW9ucywgZnVuY3Rpb24ocHVzaFJlc3BvbnNlKSB7XG4gICAgICAgIGxldCByZXNwb25zZVRleHQgPSAnJztcblxuICAgICAgICBwdXNoUmVzcG9uc2Uub24oJ2RhdGEnLCBmdW5jdGlvbihjaHVuaykge1xuICAgICAgICAgIHJlc3BvbnNlVGV4dCArPSBjaHVuaztcbiAgICAgICAgfSk7XG5cbiAgICAgICAgcHVzaFJlc3BvbnNlLm9uKCdlbmQnLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICBpZiAocHVzaFJlc3BvbnNlLnN0YXR1c0NvZGUgPCAyMDAgfHwgcHVzaFJlc3BvbnNlLnN0YXR1c0NvZGUgPiAyOTkpIHtcbiAgICAgICAgICAgIHJlamVjdChuZXcgV2ViUHVzaEVycm9yKFxuICAgICAgICAgICAgICAnUmVjZWl2ZWQgdW5leHBlY3RlZCByZXNwb25zZSBjb2RlJyxcbiAgICAgICAgICAgICAgcHVzaFJlc3BvbnNlLnN0YXR1c0NvZGUsXG4gICAgICAgICAgICAgIHB1c2hSZXNwb25zZS5oZWFkZXJzLFxuICAgICAgICAgICAgICByZXNwb25zZVRleHQsXG4gICAgICAgICAgICAgIHJlcXVlc3REZXRhaWxzLmVuZHBvaW50XG4gICAgICAgICAgICApKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmVzb2x2ZSh7XG4gICAgICAgICAgICAgIHN0YXR1c0NvZGU6IHB1c2hSZXNwb25zZS5zdGF0dXNDb2RlLFxuICAgICAgICAgICAgICBib2R5OiByZXNwb25zZVRleHQsXG4gICAgICAgICAgICAgIGhlYWRlcnM6IHB1c2hSZXNwb25zZS5oZWFkZXJzXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfSk7XG5cbiAgICAgIGlmIChyZXF1ZXN0RGV0YWlscy50aW1lb3V0KSB7XG4gICAgICAgIHB1c2hSZXF1ZXN0Lm9uKCd0aW1lb3V0JywgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcHVzaFJlcXVlc3QuZGVzdHJveShuZXcgRXJyb3IoJ1NvY2tldCB0aW1lb3V0JykpO1xuICAgICAgICB9KTtcbiAgICAgIH1cblxuICAgICAgcHVzaFJlcXVlc3Qub24oJ2Vycm9yJywgZnVuY3Rpb24oZSkge1xuICAgICAgICByZWplY3QoZSk7XG4gICAgICB9KTtcblxuICAgICAgaWYgKHJlcXVlc3REZXRhaWxzLmJvZHkpIHtcbiAgICAgICAgcHVzaFJlcXVlc3Qud3JpdGUocmVxdWVzdERldGFpbHMuYm9keSk7XG4gICAgICB9XG5cbiAgICAgIHB1c2hSZXF1ZXN0LmVuZCgpO1xuICAgIH0pO1xuICB9O1xuXG5tb2R1bGUuZXhwb3J0cyA9IFdlYlB1c2hMaWI7XG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(action-browser)/../../node_modules/.pnpm/web-push@3.6.7/node_modules/web-push/src/web-push-lib.js\n");

/***/ })

};
;